{"ast":null,"code":"import _asyncToGenerator from \"F:/statvalu/project/AR_DocuExpert_Test/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { FlatTreeControl } from '@angular/cdk/tree';\nimport { BehaviorSubject, merge } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { DirectoryService } from 'src/app/featuremodules/input-folder/services/directory.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/auth/auth.service\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"src/app/_helpers/common/commonn.service\";\nimport * as i4 from \"src/app/featuremodules/input-folder/services/directory.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/material/tree\";\nimport * as i7 from \"@angular/material/icon\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"@angular/material/progress-spinner\";\n\nfunction TreeviewComponent_mat_tree_node_1_mat_spinner_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\", 8);\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"diameter\", 30);\n  }\n}\n\nfunction TreeviewComponent_mat_tree_node_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-tree-node\", 3);\n    i0.ɵɵelementStart(1, \"mat-icon\", 4);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"i\", 5);\n    i0.ɵɵelementStart(4, \"span\", 6);\n    i0.ɵɵlistener(\"click\", function TreeviewComponent_mat_tree_node_1_Template_span_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const node_r2 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.selectedNode(node_r2);\n    });\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, TreeviewComponent_mat_tree_node_1_mat_spinner_6_Template, 1, 1, \"mat-spinner\", 7);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const node_r2 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"hidden\", node_r2.item[0].type != \"directory\");\n    i0.ɵɵattribute(\"aria-label\", \"Toggle \" + node_r2.item[0].name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.treeControl.isExpanded(node_r2) ? \"expand_more\" : \"chevron_right\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"fa-folder\", node_r2.item[0].type == \"directory\")(\"fa-file\", node_r2.item[0].type != \"directory\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(node_r2.item[0].name + \"(\" + node_r2.item[0].total_count + \")\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", node_r2.isLoading);\n  }\n}\n\nfunction TreeviewComponent_mat_tree_node_2_mat_spinner_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\", 8);\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"diameter\", 30);\n  }\n}\n\nfunction TreeviewComponent_mat_tree_node_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-tree-node\", 3);\n    i0.ɵɵelementStart(1, \"mat-icon\", 4);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"i\", 5);\n    i0.ɵɵelementStart(4, \"span\", 6);\n    i0.ɵɵlistener(\"click\", function TreeviewComponent_mat_tree_node_2_Template_span_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r9);\n      const node_r6 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.selectedNode(node_r6);\n    });\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, TreeviewComponent_mat_tree_node_2_mat_spinner_6_Template, 1, 1, \"mat-spinner\", 7);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const node_r6 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"hidden\", node_r6.item[0].type != \"directory\");\n    i0.ɵɵattribute(\"aria-label\", \"Toggle \" + node_r6.item[0].name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.treeControl.isExpanded(node_r6) ? \"expand_more\" : \"chevron_right\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"fa-folder\", node_r6.item[0].type == \"directory\")(\"fa-file\", node_r6.item[0].type != \"directory\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(node_r6.item[0].name + \"(\" + node_r6.item[0].total_count + \")\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", node_r6.isLoading);\n  }\n}\n/** Flat node with expandable and level information */\n\n\nexport class DynamicFlatNode {\n  constructor(item, level = 1, expandable = false, count, isLoading = false) {\n    this.item = item;\n    this.level = level;\n    this.expandable = expandable;\n    this.count = count;\n    this.isLoading = isLoading;\n  }\n\n} // injactable \n\nexport class DynamicDatabase {\n  constructor(_auth, http, _common) {\n    this._auth = _auth;\n    this.http = http;\n    this._common = _common;\n    this.dataMap = new Map([]);\n    this.count = 0;\n    this.rootLevelNodes = [];\n\n    this._common.$foldersTreeData.subscribe(res => {\n      this.rootLevelNodes = [res];\n      console.log(\"rootLevelNodes ??????????????????????????????????????????\", this.rootLevelNodes);\n    });\n  }\n\n  getChildNodeData(path) {\n    let formData = new FormData();\n    formData.append(\"user_id\", this._auth.user_id);\n    formData.append(\"dir_path\", path);\n    return this.http.post('/filestorage_features/recursiontree/', formData);\n  }\n\n  initialChild() {\n    this._common.$foldersTreeData.subscribe(res => {\n      this.rootLevelNodes = [res];\n    });\n  } // rootLevelNodes: object[] = [{\n  //   \"name\": this._auth.user_name,\n  //   \"id\": 0,\n  //   \"path\":'Output_Folder/' + this._auth.org_name + '/' + this._auth.user_name,\n  //   \"type\": \"directory\",\n  //   \"expanded\": false,\n  // }];\n\n  /** Initial data from database */\n\n\n  initialData() {\n    // this.initialChild()\n    return this.rootLevelNodes.map(item => new DynamicFlatNode([item], 0, true, this.count));\n  }\n\n  getNodeChildrenData(node) {\n    return new Promise((resolve, reject) => {\n      console.log(\"in new data get section\");\n      this.getChildNodeData(node[0].path).subscribe(res => {\n        console.log(\"child response\", res.res_data.jsonData.children);\n\n        if (res.res_data.jsonData.children.length > 0) {\n          this.dataMap.set(node[0].path, res.res_data.jsonData.children);\n          resolve(this.dataMap);\n        }\n      });\n    });\n  }\n\n  getChildren(node) {\n    console.log(\"*****\", node, node[0].name, this.dataMap.get(node[0].path));\n    return this.dataMap.get(node[0].path);\n  }\n\n  isExpandable(node) {\n    console.log(\">>>>>>>\", node);\n    console.log(\">>>>>>>\", node, this.dataMap.has(node.path));\n    return this.dataMap.has(node.path);\n  }\n\n}\n\nDynamicDatabase.ɵfac = function DynamicDatabase_Factory(t) {\n  return new (t || DynamicDatabase)(i0.ɵɵinject(i1.AuthService), i0.ɵɵinject(i2.HttpClient), i0.ɵɵinject(i3.CommonnService));\n};\n\nDynamicDatabase.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: DynamicDatabase,\n  factory: DynamicDatabase.ɵfac,\n  providedIn: 'root'\n}); ///////\n\nexport class DynamicDataSource {\n  constructor(_treeControl, _database) {\n    this._treeControl = _treeControl;\n    this._database = _database;\n    this.dataChange = new BehaviorSubject([]);\n  }\n\n  get data() {\n    return this.dataChange.value;\n  }\n\n  set data(value) {\n    this._treeControl.dataNodes = value;\n    this.dataChange.next(value);\n  }\n\n  connect(collectionViewer) {\n    this._treeControl.expansionModel.changed.subscribe(change => {\n      if (change.added || change.removed) {\n        this.handleTreeControl(change);\n      }\n    });\n\n    return merge(collectionViewer.viewChange, this.dataChange).pipe(map(() => this.data));\n  }\n\n  disconnect(collectionViewer) {}\n  /** Handle expand/collapse behaviors */\n\n\n  handleTreeControl(change) {\n    if (change.added) {\n      change.added.forEach(node => this.toggleNode(node, true));\n    }\n\n    if (change.removed) {\n      change.removed.slice().reverse().forEach(node => this.toggleNode(node, false));\n    }\n  }\n  /**\r\n   * Toggle the node, remove from display list\r\n   */\n\n\n  toggleNode(node, expand) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      node.isLoading = true;\n      console.log(\"start here .......>>>>\", node, node.item[0], expand);\n      const result = yield _this._database.getNodeChildrenData(node.item);\n      console.log(\"promise result is ....\", result);\n      const children = yield _this._database.getChildren(node.item);\n      console.log('childrens are', children);\n      console.log('data is', _this.data);\n\n      const index = _this.data.indexOf(node);\n\n      console.log('index is', index, !children || index < 0);\n\n      if (!children || index < 0) {\n        // If no children, or cannot find the node, no op\n        return;\n      }\n\n      setTimeout(() => {\n        if (expand) {\n          const nodes = children.map(name => new DynamicFlatNode([name], node.level + 1, _this._database.isExpandable(name), children.length));\n\n          _this.data.splice(index + 1, 0, ...nodes);\n        } else {\n          let count = 0;\n\n          for (let i = index + 1; i < _this.data.length && _this.data[i].level > node.level; i++, count++) {}\n\n          _this.data.splice(index + 1, count);\n        } // notify the change\n\n\n        _this.dataChange.next(_this.data);\n\n        node.isLoading = false;\n      }, 1000);\n    })();\n  }\n\n} // export class TreeviewComponent implements OnInit {\n//   constructor() { }\n// }\n\nexport class TreeviewComponent {\n  constructor(database, _common, _directory, route, router) {\n    this.database = database;\n    this._common = _common;\n    this._directory = _directory;\n    this.route = route;\n    this.router = router;\n\n    this.getLevel = node => node.level;\n\n    this.isExpandable = node => node.expandable;\n\n    this.hasChild = (_, _nodeData) => _nodeData.expandable;\n\n    this.router.routeReuseStrategy.shouldReuseRoute = () => {\n      console.log(\"change param\");\n      this.initialFunction();\n      return true;\n    };\n\n    this.initialFunction();\n  }\n\n  ngOnInit() {\n    console.log(\"ngoninit called\");\n  }\n\n  initialFunction() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.treeControl = new FlatTreeControl(_this2.getLevel, _this2.isExpandable);\n      _this2.dataSource = new DynamicDataSource(_this2.treeControl, _this2.database);\n      _this2.dataSource.data = yield _this2.database.initialData();\n      console.log(\"initial data\", _this2.dataSource.data);\n    })();\n  }\n\n  selectedNode(val) {\n    console.log(\"selectedNode is\", val.item[0].path);\n    console.log(\"addd val\", this.database.dataMap);\n    this.redirectUserToDir(val.item[0].path);\n\n    this._directory.getChildNodeData(val.item[0].path).subscribe(res => {\n      console.log(\"child response\", res.res_data.jsonData.children);\n\n      if (res.res_data.jsonData.children.length > 0) {\n        this.database.dataMap.set(val.item[0].path, res.res_data.jsonData.children);\n      }\n    }); // this.database.dataMap.set(\"Output_Folder/ORG@STS/shubham21/BibleData\", [\n    //   {\n    //     \"name\": \"02_Certified Non-Incident Statement_2021.06.12 (002)_output\",\n    //     \"id\": 1,\n    //     \"path\": \"Output_Folder/ORG@STS/shubham21/BibleData/02_Certified Non-Incident Statement_2021.06.12 (002)_output\",\n    //     \"type\": \"directory\",\n    //     \"expanded\": false,\n    //     \"children\": []\n    //   },\n    //   {\n    //     \"name\": \"00___086_output\",\n    //     \"id\": 1,\n    //     \"path\": \"Output_Folder/ORG@STS/shubham21/BibleData/00___086_output\",\n    //     \"type\": \"directory\",\n    //     \"expanded\": false,\n    //     \"children\": []\n    //   },\n    //   {\n    //     \"name\": \"1. Current Time In Service 13-May-2019_output\",\n    //     \"id\": 1,\n    //     \"path\": \"Output_Folder/ORG@STS/shubham21/BibleData/1. Current Time In Service 13-May-2019_output\",\n    //     \"type\": \"directory\",\n    //     \"expanded\": false,\n    //     \"children\": []\n    //   },\n    //   {\n    //     \"name\": \"output\",\n    //     \"id\": 1,\n    //     \"path\": \"Output_Folder/ORG@STS/shubham21/BibleData/output\",\n    //     \"type\": \"directory\",\n    //     \"expanded\": false,\n    //     \"children\": []\n    //   }\n    // ])\n\n\n    console.log(\"addd val\", this.database.dataMap);\n  }\n\n  redirectUserToDir(path) {\n    console.log(\"in redirect user to dir>>>>>>>>>>>>>\", path);\n    path = path + '/';\n\n    if (path.includes('Input')) {\n      this._common.redirectToNestedFolder(path, 'input');\n    } else if (path.includes('Req')) {\n      this._common.redirectToNestedFolder(path, 'req');\n    } else if (path.includes('Err_Info')) {\n      this._common.redirectToNestedFolder(path, 'err');\n    } else if (path.includes('Output')) {\n      this._common.redirectToNestedFolder(path, 'output');\n    }\n  }\n\n}\n\nTreeviewComponent.ɵfac = function TreeviewComponent_Factory(t) {\n  return new (t || TreeviewComponent)(i0.ɵɵdirectiveInject(DynamicDatabase), i0.ɵɵdirectiveInject(i3.CommonnService), i0.ɵɵdirectiveInject(i4.DirectoryService), i0.ɵɵdirectiveInject(i5.ActivatedRoute), i0.ɵɵdirectiveInject(i5.Router));\n};\n\nTreeviewComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: TreeviewComponent,\n  selectors: [[\"app-treeview\"]],\n  features: [i0.ɵɵProvidersFeature([DirectoryService])],\n  decls: 3,\n  vars: 3,\n  consts: [[3, \"dataSource\", \"treeControl\"], [\"matTreeNodePadding\", \"\", 4, \"matTreeNodeDef\"], [\"matTreeNodePadding\", \"\", 4, \"matTreeNodeDef\", \"matTreeNodeDefWhen\"], [\"matTreeNodePadding\", \"\"], [\"matTreeNodeToggle\", \"\", 1, \"mat-icon-rtl-mirror\", 3, \"hidden\"], [1, \"fas\"], [3, \"click\"], [\"mode\", \"indeterminate\", \"class\", \"example-tree-progress-bar\", 3, \"diameter\", 4, \"ngIf\"], [\"mode\", \"indeterminate\", 1, \"example-tree-progress-bar\", 3, \"diameter\"]],\n  template: function TreeviewComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"mat-tree\", 0);\n      i0.ɵɵtemplate(1, TreeviewComponent_mat_tree_node_1_Template, 7, 9, \"mat-tree-node\", 1);\n      i0.ɵɵtemplate(2, TreeviewComponent_mat_tree_node_2_Template, 7, 9, \"mat-tree-node\", 2);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"dataSource\", ctx.dataSource)(\"treeControl\", ctx.treeControl);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"matTreeNodeDefWhen\", ctx.hasChild);\n    }\n  },\n  directives: [i6.MatTree, i6.MatTreeNodeDef, i6.MatTreeNode, i6.MatTreeNodePadding, i7.MatIcon, i6.MatTreeNodeToggle, i8.NgIf, i9.MatSpinner],\n  styles: [\".example-tree-progress-bar[_ngcontent-%COMP%] {\\n  margin-left: 30px;\\n}\\n\\n#aria-level[_ngcontent-%COMP%] {\\n  padding-left: 20px;\\n}\\n\\n.fa-folder[_ngcontent-%COMP%] {\\n  color: #ffb32c;\\n  margin-right: 10px;\\n  position: relative;\\n  top: 1px;\\n}\\n\\n.fa-file[_ngcontent-%COMP%] {\\n  color: #ffb32c;\\n  margin-right: 10px;\\n  position: relative;\\n  top: 1px;\\n}\\n\\n.mat-tree[_ngcontent-%COMP%] {\\n  background: #c0c0c0;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRyZWV2aWV3LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsaUJBQUE7QUFDRjs7QUFFQTtFQUNFLGtCQUFBO0FBQ0Y7O0FBRUE7RUFDRSxjQUFBO0VBQ0Esa0JBQUE7RUFDQSxrQkFBQTtFQUNBLFFBQUE7QUFDRjs7QUFFQTtFQUNFLGNBQUE7RUFDQSxrQkFBQTtFQUNBLGtCQUFBO0VBQ0EsUUFBQTtBQUNGOztBQUVBO0VBQ0UsbUJBQUE7QUFDRiIsImZpbGUiOiJ0cmVldmlldy5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5leGFtcGxlLXRyZWUtcHJvZ3Jlc3MtYmFyIHtcclxuICBtYXJnaW4tbGVmdDogMzBweDtcclxufVxyXG5cclxuI2FyaWEtbGV2ZWwge1xyXG4gIHBhZGRpbmctbGVmdDogMjBweDtcclxufVxyXG5cclxuLmZhLWZvbGRlciB7XHJcbiAgY29sb3I6ICNmZmIzMmM7XHJcbiAgbWFyZ2luLXJpZ2h0OiAxMHB4O1xyXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICB0b3A6IDFweDtcclxufVxyXG5cclxuLmZhLWZpbGUge1xyXG4gIGNvbG9yOiAjZmZiMzJjO1xyXG4gIG1hcmdpbi1yaWdodDogMTBweDtcclxuICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgdG9wOiAxcHg7XHJcbn1cclxuXHJcbi5tYXQtdHJlZSB7XHJcbiAgYmFja2dyb3VuZDogI2MwYzBjMCA7XHJcbn0iXX0= */\"]\n});","map":{"version":3,"sources":["F:\\statvalu\\project\\AR_DocuExpert_Test\\src\\app\\shared\\treeview\\treeview.component.ts","F:\\statvalu\\project\\AR_DocuExpert_Test\\src\\app\\shared\\treeview\\treeview.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, Injectable } from '@angular/core';\nimport {\n  CollectionViewer,\n  SelectionChange,\n  DataSource,\n} from '@angular/cdk/collections';\nimport { FlatTreeControl } from '@angular/cdk/tree';\nimport { BehaviorSubject, merge, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { CommonnService } from 'src/app/_helpers/common/commonn.service';\nimport { DirectoryService } from 'src/app/featuremodules/input-folder/services/directory.service';\nimport { AuthService } from 'src/app/auth/auth.service';\nimport { HttpClient } from '@angular/common/http';\nimport { Router,ActivatedRoute } from '@angular/router';\n\n\n\n\n/** Flat node with expandable and level information */\nexport class DynamicFlatNode {\n  constructor(\n    public item: object[],\n    public level = 1,\n    public expandable = false,\n    public count:Number,\n    public isLoading = false\n  ) { }\n}\n\n// injactable \n@Injectable({ providedIn: 'root',})\nexport class DynamicDatabase {\n  constructor(private _auth: AuthService,private http:HttpClient,private _common:CommonnService){\n    this._common.$foldersTreeData.subscribe((res:any) => {\n      this.rootLevelNodes = [res];\n      console.log(\"rootLevelNodes ??????????????????????????????????????????\",this.rootLevelNodes)\n    });\n  }\n  dataMap = new Map<string, object[]>([]);\n  count:Number=0\n\n  rootLevelNodes: object[] = [];\n\n  \n\n  getChildNodeData(path:string){\n    let formData = new FormData;\n    formData.append(\"user_id\", this._auth.user_id);\n    formData.append(\"dir_path\", path);\n\n    return this.http.post('/filestorage_features/recursiontree/', formData);\n  }\n  \n  initialChild(){\n    this._common.$foldersTreeData.subscribe((res:any) => {\n      this.rootLevelNodes = [res];\n    });\n  }\n\n  // rootLevelNodes: object[] = [{\n  //   \"name\": this._auth.user_name,\n  //   \"id\": 0,\n  //   \"path\":'Output_Folder/' + this._auth.org_name + '/' + this._auth.user_name,\n  //   \"type\": \"directory\",\n  //   \"expanded\": false,\n  // }];\n\n  /** Initial data from database */\n  initialData(): DynamicFlatNode[] {\n    // this.initialChild()\n    return this.rootLevelNodes.map(\n      (item) => new DynamicFlatNode([item], 0, true,this.count)\n    );\n  }\n\n   getNodeChildrenData(node:any){\n    return new Promise((resolve, reject) => {\n      console.log(\"in new data get section\")\n      this.getChildNodeData(node[0].path).subscribe((res: any) => {\n          console.log(\"child response\",res.res_data.jsonData.children)\n          if(res.res_data.jsonData.children.length>0){\n            this.dataMap.set(node[0].path,res.res_data.jsonData.children)\n            resolve(this.dataMap)\n          }\n        });\n    })\n    }\n\n   getChildren(node: any) {\n    console.log(\"*****\", node, node[0].name, this.dataMap.get(node[0].path))\n    return this.dataMap.get(node[0].path);\n  }\n\n  isExpandable(node: any): boolean {\n    console.log(\">>>>>>>\", node)\n    console.log(\">>>>>>>\", node, this.dataMap.has(node.path))\n    return this.dataMap.has(node.path);\n  }\n}\n\n///////\nexport class DynamicDataSource implements DataSource<DynamicFlatNode> {\n  dataChange = new BehaviorSubject<DynamicFlatNode[]>([]);\n\n  get data(): DynamicFlatNode[] {\n    return this.dataChange.value;\n  }\n  set data(value: DynamicFlatNode[]) {\n    this._treeControl.dataNodes = value;\n    this.dataChange.next(value);\n  }\n\n  constructor(\n    private _treeControl: FlatTreeControl<DynamicFlatNode>,\n    private _database: DynamicDatabase\n  ) { }\n\n  connect(collectionViewer: CollectionViewer): Observable<DynamicFlatNode[]> {\n    this._treeControl.expansionModel.changed.subscribe((change) => {\n      if (\n        (change as SelectionChange<DynamicFlatNode>).added ||\n        (change as SelectionChange<DynamicFlatNode>).removed\n      ) {\n        this.handleTreeControl(change as SelectionChange<DynamicFlatNode>);\n      }\n    });\n\n    return merge(collectionViewer.viewChange, this.dataChange).pipe(\n      map(() => this.data)\n    );\n  }\n\n  disconnect(collectionViewer: CollectionViewer): void { }\n\n  /** Handle expand/collapse behaviors */\n  handleTreeControl(change: SelectionChange<DynamicFlatNode>) {\n    if (change.added) {\n      change.added.forEach((node) => this.toggleNode(node, true));\n    }\n    if (change.removed) {\n      change.removed\n        .slice()\n        .reverse()\n        .forEach((node) => this.toggleNode(node, false));\n    }\n  }\n\n  /**\n   * Toggle the node, remove from display list\n   */\n  async toggleNode(node: DynamicFlatNode, expand: boolean) {\n    node.isLoading = true;\n    console.log(\"start here .......>>>>\",node,node.item[0],expand)\n   const result= await this._database.getNodeChildrenData(node.item)\n   console.log(\"promise result is ....\",result)\n    const children =await this._database.getChildren(node.item);\n    console.log('childrens are', children);\n    console.log('data is', this.data);\n    const index = this.data.indexOf(node);\n    console.log('index is', index, (!children || index < 0));\n    if (!children || index < 0) {\n      // If no children, or cannot find the node, no op\n      return;\n    }\n\n\n    setTimeout(() => {\n      if (expand) {\n        const nodes = children.map(\n          (name) =>\n            new DynamicFlatNode(\n              [name],\n              node.level + 1,\n              this._database.isExpandable(name),\n              children.length\n            )\n        );\n        this.data.splice(index + 1, 0, ...nodes);\n      } else {\n        let count = 0;\n        for (\n          let i = index + 1;\n          i < this.data.length && this.data[i].level > node.level;\n          i++, count++\n        ) { }\n        this.data.splice(index + 1, count);\n      }\n\n      // notify the change\n      this.dataChange.next(this.data);\n      node.isLoading = false;\n    }, 1000);\n  }\n \n}\n\n\n\n@Component({\n  selector: 'app-treeview',\n  templateUrl: './treeview.component.html',\n  styleUrls: ['./treeview.component.scss'],\n  providers: [DirectoryService]\n\n})\n// export class TreeviewComponent implements OnInit {\n\n//   constructor() { }\n\n  \n\n// }\nexport class TreeviewComponent implements OnInit{\n  constructor(private database: DynamicDatabase,private _common: CommonnService,private _directory: DirectoryService,private route: ActivatedRoute,private router: Router) {\n\n    this.router.routeReuseStrategy.shouldReuseRoute = () => {\n      console.log(\"change param\")\n      this.initialFunction()\n      return true;\n    }\n\n    this.initialFunction()\n   \n  }\n\n  ngOnInit(): void {\n    console.log(\"ngoninit called\")\n  }\n\n  async initialFunction() {\n    this.treeControl = new FlatTreeControl<DynamicFlatNode>(\n      this.getLevel,\n      this.isExpandable\n    );\n    this.dataSource = new DynamicDataSource(this.treeControl, this.database);\n\n    this.dataSource.data =await this.database.initialData();\n    console.log(\"initial data\", this.dataSource.data)\n  }\n\n\n  //   ngOnInit(): void {\n  //    this.dataSource.data = await this.database.initialData();\n\n  // }\n\n  treeControl: FlatTreeControl<DynamicFlatNode>;\n\n  dataSource: DynamicDataSource;\n\n  getLevel = (node: DynamicFlatNode) => node.level;\n\n  isExpandable = (node: DynamicFlatNode) => node.expandable;\n\n  hasChild = (_: number, _nodeData: DynamicFlatNode) => _nodeData.expandable;\n\n  selectedNode(val: any) {\n    console.log(\"selectedNode is\", val.item[0].path)\n    console.log(\"addd val\", this.database.dataMap)\n   this.redirectUserToDir(val.item[0].path)\n\n    this._directory.getChildNodeData(val.item[0].path).subscribe((res: any) => {\n  console.log(\"child response\",res.res_data.jsonData.children)\n  if(res.res_data.jsonData.children.length>0){\n  this.database.dataMap.set(val.item[0].path,res.res_data.jsonData.children)\n  }\n});\n\n    // this.database.dataMap.set(\"Output_Folder/ORG@STS/shubham21/BibleData\", [\n    //   {\n    //     \"name\": \"02_Certified Non-Incident Statement_2021.06.12 (002)_output\",\n    //     \"id\": 1,\n    //     \"path\": \"Output_Folder/ORG@STS/shubham21/BibleData/02_Certified Non-Incident Statement_2021.06.12 (002)_output\",\n    //     \"type\": \"directory\",\n    //     \"expanded\": false,\n    //     \"children\": []\n    //   },\n    //   {\n    //     \"name\": \"00___086_output\",\n    //     \"id\": 1,\n    //     \"path\": \"Output_Folder/ORG@STS/shubham21/BibleData/00___086_output\",\n    //     \"type\": \"directory\",\n    //     \"expanded\": false,\n    //     \"children\": []\n    //   },\n    //   {\n    //     \"name\": \"1. Current Time In Service 13-May-2019_output\",\n    //     \"id\": 1,\n    //     \"path\": \"Output_Folder/ORG@STS/shubham21/BibleData/1. Current Time In Service 13-May-2019_output\",\n    //     \"type\": \"directory\",\n    //     \"expanded\": false,\n    //     \"children\": []\n    //   },\n    //   {\n    //     \"name\": \"output\",\n    //     \"id\": 1,\n    //     \"path\": \"Output_Folder/ORG@STS/shubham21/BibleData/output\",\n    //     \"type\": \"directory\",\n    //     \"expanded\": false,\n    //     \"children\": []\n    //   }\n    // ])\n\n    console.log(\"addd val\", this.database.dataMap)\n  }\n\n  redirectUserToDir(path: string) {\n    console.log(\"in redirect user to dir>>>>>>>>>>>>>\",path)\n    path = path + '/'\n    if (path.includes('Input')) {\n      this._common.redirectToNestedFolder(path, 'input');\n    } else if (path.includes('Req')) {\n      this._common.redirectToNestedFolder(path, 'req');\n    } else if (path.includes('Err_Info')) {\n      this._common.redirectToNestedFolder(path, 'err');\n    } else if (path.includes('Output')) {\n      this._common.redirectToNestedFolder(path, 'output');\n    }\n  }\n\n}","<mat-tree [dataSource]=\"dataSource\" [treeControl]=\"treeControl\">\n  <mat-tree-node *matTreeNodeDef=\"let node\" matTreeNodePadding >\n    <mat-icon class=\"mat-icon-rtl-mirror\" [hidden]=\"node.item[0].type!='directory'\" [attr.aria-label]=\"'Toggle ' + node.item[0].name\" matTreeNodeToggle>\n      {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}\n    </mat-icon>\n    <i class=\"fas\" [class.fa-folder]=\"node.item[0].type=='directory'\" [class.fa-file]=\"node.item[0].type!='directory'\"></i> \n    <span (click)=\"selectedNode(node)\">{{node.item[0].name+\"(\"+node.item[0].total_count+\")\"}}</span>\n    <mat-spinner [diameter]=\"30\" *ngIf=\"node.isLoading\" mode=\"indeterminate\" class=\"example-tree-progress-bar\">\n    </mat-spinner>\n  </mat-tree-node>\n  <mat-tree-node *matTreeNodeDef=\"let node; when: hasChild\" matTreeNodePadding>\n    <mat-icon class=\"mat-icon-rtl-mirror\" [hidden]=\"node.item[0].type!='directory'\" [attr.aria-label]=\"'Toggle ' + node.item[0].name\" matTreeNodeToggle>\n      {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}\n    </mat-icon>\n    <i class=\"fas\" [class.fa-folder]=\"node.item[0].type=='directory'\" [class.fa-file]=\"node.item[0].type!='directory'\"></i>\n    <span (click)=\"selectedNode(node)\">{{node.item[0].name+\"(\"+node.item[0].total_count+\")\"}}</span>\n    <mat-spinner [diameter]=\"30\" *ngIf=\"node.isLoading\" mode=\"indeterminate\" class=\"example-tree-progress-bar\">\n    </mat-spinner>\n  </mat-tree-node>\n  <!-- <mat-spinner [diameter]=\"30\" *ngIf=\"nodeItems.length === 0\"></mat-spinner> -->\n</mat-tree>"],"sourceRoot":""},"metadata":{},"sourceType":"module"}