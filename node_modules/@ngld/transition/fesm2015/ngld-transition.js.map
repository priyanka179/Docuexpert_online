{"version":3,"file":"ngld-transition.js","sources":["../../src/lib/easing.function.ts","../../src/lib/transition.service.ts","../../src/lib/transition.class.ts","../../src/lib/trigger.class.ts","../../src/lib/transition.meta-def.ts","../../src/public-api.ts","../../src/ngld-transition.ts"],"sourcesContent":["export type EasingFunc = (t: number) => number;\n\n/**\n * No easing, no acceleration\n */\nexport function linear(t: number): number {\n  return t;\n}\n\n/**\n * Accelerating from zero velocity\n */\nexport function easeInQuad(t: number): number {\n  return t * t;\n}\n\n/**\n * Decelerating to zero velocity\n */\nexport function easeOutQuad(t: number): number {\n  return t * (2 - t);\n}\n\n/**\n * Acceleration until halfway, then deceleration\n */\nexport function easeInOutQuad(t: number): number {\n  return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n}\n\n/**\n * Accelerating from zero velocity\n */\nexport function easeInCubic(t: number): number {\n  return t * t * t;\n}\n\n/**\n * Decelerating to zero velocity\n */\nexport function easeOutCubic(t: number): number {\n  return (--t) * t * t + 1;\n}\n\n/**\n * Acceleration until halfway, then deceleration\n */\nexport function easeInOutCubic(t: number): number {\n  return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n}\n\n/**\n * Accelerating from zero velocity\n */\nexport function easeInQuart(t: number): number {\n  return t * t * t * t;\n}\n\n/**\n * Decelerating to zero velocity\n */\nexport function easeOutQuart(t: number): number {\n  return 1 - (--t) * t * t * t;\n}\n\n/**\n * Acceleration until halfway, then deceleration\n */\nexport function easeInOutQuart(t: number): number {\n  return t < .5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t;\n}\n\n/**\n * Accelerating from zero velocity\n */\nexport function easeInQuint(t: number): number {\n  return t * t * t * t * t;\n}\n\n/**\n * Decelerating to zero velocity\n */\nexport function easeOutQuint(t: number): number {\n  return 1 + (--t) * t * t * t * t;\n}\n\n/**\n * Acceleration until halfway, then deceleration\n */\nexport function easeInOutQuint(t: number): number {\n  return t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t;\n}\n","import { Injectable, Optional } from '@angular/core';\nimport { Trigger } from './trigger.class';\n\nexport class InvalidTriggerRegisterError extends Error {\n\n  constructor() {\n    super('Could not find triggers registered in the transition.');\n  }\n}\n\n@Injectable()\nexport class TransitionService {\n\n  constructor(\n    @Optional() public triggers: Trigger[],\n  ) { }\n\n  /**\n   * animate\n   */\n  public async animate(triggerName: string, from: string, to: string, param: any): Promise<any> {\n    if (!Array.isArray(this.triggers)) {\n      return Promise.reject(new InvalidTriggerRegisterError());\n    }\n    const trigger = this.triggers.find(trig => trig.name === triggerName);\n    if (!trigger) {\n      console.warn(`Trigger ${triggerName} is not defined.`);\n      return Promise.resolve();\n    }\n    const transition = trigger.transitions.find(trans => trans.validate(from, to));\n    if (!transition) {\n      console.warn(`Transition ${from} => ${to} is not defined`);\n      return Promise.resolve();\n    }\n    if (!requestAnimationFrame) {\n      // requestAnimationFrame API is not available in current browser.\n      // https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame\n      transition.steps.forEach(step => step(1, param));\n      return Promise.resolve();\n    }\n    return Promise.all(transition.steps.map(render => new Promise((resolve) => {\n      const start = Date.now();\n      (function loop(): void {\n        const p = (Date.now() - start) / transition.duration;\n        if (p > 1) {\n          render(1, param);\n          resolve(render);\n        } else {\n          requestAnimationFrame(loop);\n          render(transition.easing(p), param);\n        }\n      })();\n    })));\n  }\n}\n","import { EasingFunc, RenderState } from './types';\n\nexport class Transition {\n\n  public steps: RenderState<any>[] = [];\n  public duration = 1;\n  public easing: EasingFunc = () => null;\n\n  constructor(\n    public validate: ((fromtState: string, toState: string) => boolean),\n  ) { }\n}\n","import { Transition } from './transition.class';\n\nexport class Trigger {\n\n  public transitions: Transition[] = [];\n\n  constructor(\n    public name: string) {\n  }\n}\n","import { Transition } from './transition.class';\nimport { RenderState, EasingFunc } from './types';\nimport { Trigger } from './trigger.class';\n\ntype AnimationMetadata = (trig: Trigger) => void;\ntype TransitionMetadata = (transition: Transition) => void;\n\nexport function trigger(name: string, definition: AnimationMetadata[]): Trigger {\n  const result = new Trigger(name);\n  definition.forEach(def => def(result));\n  return result;\n}\n\nexport function transition(\n  stateChangeExpr: ((fromtState: string, toState: string) => boolean),\n  steps: TransitionMetadata[]): AnimationMetadata {\n  const transResult = new Transition(stateChangeExpr);\n  steps.forEach(stepDef => stepDef(transResult));\n  return (trig: Trigger) => {\n    trig.transitions.push(transResult);\n  };\n}\n\nexport function render<T>(state: RenderState<T>): TransitionMetadata {\n  return (trans: Transition) => {\n    trans.steps.push(state);\n  };\n}\n\nexport function animate(duration: number, easing: EasingFunc): TransitionMetadata {\n  return (trans: Transition) => {\n    trans.duration = duration;\n    trans.easing = easing;\n  };\n}\n","/*\n * Public API Surface of transition\n */\nimport * as Easing from './lib/easing.function';\n\nexport * from './lib/transition.service';\n// export * from './lib/transition.module';\nexport * from './lib/transition.meta-def';\nexport { Easing };\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {Trigger as Éµa} from './lib/trigger.class';"],"names":[],"mappings":"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"}