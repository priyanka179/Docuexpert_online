import { __awaiter } from "tslib";
import { Component, ViewChild, Input, Optional, Output, EventEmitter, Injectable } from '@angular/core';
import { Easing, trigger, transition, render, TransitionService, animate } from '@ngld/transition';
import { PLUS_ICON_PROVIDER } from '@ngld/icon/plus.icon';
import { REMOVE_ICON_PROVIDER } from '@ngld/icon/remove.icon';
import { UNLOCK_ICON_PROVIDER } from '@ngld/icon/unlock.icon';
import { SvgIconRegistry } from '@ngld/icon';
import { nanoid } from 'nanoid';
import * as rfdc from 'rfdc';
import { forceSimulation, forceCollide, forceManyBody, forceLink, forceCenter } from 'd3-force';
import { interpolateZoom } from 'd3-interpolate';
import { GraphContainer } from './graph.container';
import { ColorProviderService, DefaultColorProviderService } from './color-provider.service';
import { ActiveIndividualStoreService } from './active-individual-store.service';
import { rotatePoint, rotation, unitaryNormalVector, unitaryVector } from './utils';
const clone = rfdc();
const interpolateRadius = interpolateZoom([0, 0, 33], [0, 0, 66]);
const cosineStart = Math.cos(2 * Math.PI / 180);
const sineStart = Math.sin(2 * Math.PI / 180);
const cosineEnd = Math.cos(120 * Math.PI / 180);
const sineEnd = Math.sin(120 * Math.PI / 180);
export class AnimationTranstion extends TransitionService {
    constructor() {
        super([
            trigger('openClose', [
                transition((from, to) => from === 'void' && to === 'open', [
                    render((p, node) => {
                        const radiusOuter = interpolateRadius(p)[2];
                        // sin(2) * 33, cos(2) * 33
                        node.pathDrawn.A1 = { x: sineStart * 33, y: -cosineStart * 33 };
                        // sin(120) * 33, cos(120) * 33
                        node.pathDrawn.B1 = { x: sineEnd * 33, y: -cosineEnd * 33 };
                        // sin(120) * 63, cos(120) * 63
                        node.pathDrawn.C1 = { x: sineEnd * radiusOuter, y: -cosineEnd * radiusOuter };
                        // sin(2) * 63, cos(2) * 63
                        node.pathDrawn.D1 = { x: sineStart * radiusOuter, y: -cosineStart * radiusOuter };
                        node.pathDrawn.R1.outer = radiusOuter;
                    }),
                    animate(200, Easing.easeInCubic),
                ]),
                transition((from, to) => from === 'open' && to === 'void', [
                    render((p, node) => {
                        const radiusOuter = interpolateRadius(1 - p)[2];
                        // sin(2) * 33, cos(2) * 33
                        node.pathDrawn.A1 = { x: sineStart * 33, y: -cosineStart * 33 };
                        // sin(120) * 33, cos(120) * 33
                        node.pathDrawn.B1 = { x: sineEnd * 33, y: -cosineEnd * 33 };
                        // sin(120) * 63, cos(120) * 63
                        node.pathDrawn.C1 = { x: sineEnd * radiusOuter, y: -cosineEnd * radiusOuter };
                        // sin(2) * 63, cos(2) * 63
                        node.pathDrawn.D1 = { x: sineStart * radiusOuter, y: -cosineStart * radiusOuter };
                        node.pathDrawn.R1.outer = radiusOuter;
                    }),
                    animate(200, Easing.easeOutCubic),
                ]),
            ]),
        ]);
    }
}
AnimationTranstion.decorators = [
    { type: Injectable }
];
AnimationTranstion.ctorParameters = () => [];
export class LinkedDataGraphicComponent {
    constructor(transitionService, colorProvider, activeIndividualStore) {
        this.transitionService = transitionService;
        this.colorProvider = colorProvider;
        this.activeIndividualStore = activeIndividualStore;
        this.nodeRadius = 25;
        this.arrowSize = 4;
        this.minCollision = 60;
        this.zoomFit = false;
        this.graphUpdated = new EventEmitter();
        this.$states = {
            debug: false,
            dashedArrow: null,
            relationRemove: false,
        };
        this.canvasViewBox = {
            minX: 0,
            minY: 0,
            width: 800,
            height: 500,
        };
        this.initialLoad = true;
        this.highlightChecker = (node) => false;
        if (!this.activeIndividualStore) {
            this.activeIndividualStore = new ActiveIndividualStoreService();
        }
        if (!this.colorProvider) {
            this.colorProvider = new DefaultColorProviderService();
        }
        this.d3Graph = new GraphContainer(this.colorProvider);
    }
    set debug(state) {
        this.$states.debug = state;
    }
    set graph(g) {
        this.initGraph = g;
    }
    set relationRemove(state) {
        this.$states.relationRemove = state;
    }
    ngOnInit() {
        return __awaiter(this, void 0, void 0, function* () {
            this.simulation = this.newSimulation();
            this.initGraph.nodes.forEach(node => this.d3Graph.addNode(clone(node)));
            this.initGraph.relationships.forEach(rel => this.d3Graph.addRelation(clone(rel)));
            this.reloadSimulation();
            const mainCanvasSize = this.getMainCanvasSize();
            this.canvasViewBox = {
                minX: 0, minY: 0, width: mainCanvasSize.width, height: mainCanvasSize.height,
            };
        });
    }
    getMainCanvasSize() {
        return this.mainCanvas.nativeElement.getBoundingClientRect();
    }
    newSimulation() {
        const simulation = forceSimulation();
        const mainCanvasSize = this.getMainCanvasSize();
        simulation
            .force('collide', forceCollide()
            .radius(d => this.minCollision).iterations(2))
            .force('charge', forceManyBody())
            .force('link', forceLink().id(d => d.id + ''))
            .force('center', forceCenter(mainCanvasSize.width / 2, mainCanvasSize.height / 2))
            .on('tick', () => {
            this.d3Graph.nodes.forEach(node => {
                if (!node.controlledByDragging) {
                    node.translate.x = node.x;
                    node.translate.y = node.y;
                }
            });
            this.d3Graph.relationships.forEach(rel => {
                const center = { x: 0, y: 0 };
                const source = rel.source;
                const target = rel.target;
                const angle = rotation(source, target);
                rel.rotate = rotation(source, rel.target);
                // [SOURCE] --textMargin--[TEXT]--textMargin-->[TARGET]
                // [SOURCE] --textMargin--textMargin--[TEXT]-->[TARGET]
                // --textMargin--textMargin--[TEXT]-- = [SOURCE]-->[TARGET]
                const n = unitaryNormalVector(source, target);
                const u = unitaryVector(source, target);
                const textMargin = {
                    y: (target.y - source.y - (rel.textBoxSize.width + 10) * u.y) * 0.5,
                    x: (target.x - source.x - (rel.textBoxSize.width + 10) * u.x) * 0.5,
                };
                // => u is simple scale of textMargin
                // => n is perpendicular to textMargin
                rel.pathDrawn.A1 = rotatePoint(center, {
                    x: 0 + (this.nodeRadius + 1) * u.x - n.x,
                    y: 0 + (this.nodeRadius + 1) * u.y - n.y,
                }, angle);
                rel.pathDrawn.B1 = rotatePoint(center, {
                    x: textMargin.x - n.x,
                    y: textMargin.y - n.y,
                }, angle);
                rel.pathDrawn.C1 = rotatePoint(center, {
                    x: textMargin.x,
                    y: textMargin.y,
                }, angle);
                rel.pathDrawn.D1 = rotatePoint(center, {
                    x: 0 + (this.nodeRadius + 1) * u.x,
                    y: 0 + (this.nodeRadius + 1) * u.y,
                }, angle);
                // length(C-B) = length(D-A) = length(n) = 1
                rel.pathDrawn.A2 = rotatePoint(center, {
                    x: target.x - source.x - textMargin.x - n.x,
                    y: target.y - source.y - textMargin.y - n.y,
                }, angle);
                rel.pathDrawn.B2 = rotatePoint(center, {
                    x: target.x - source.x - (this.nodeRadius + 1) * u.x - n.x - u.x * this.arrowSize,
                    y: target.y - source.y - (this.nodeRadius + 1) * u.y - n.y - u.y * this.arrowSize,
                }, angle);
                rel.pathDrawn.C2 = rotatePoint(center, {
                    x: target.x - source.x - (this.nodeRadius + 1) * u.x - n.x + (n.x - u.x) * this.arrowSize,
                    y: target.y - source.y - (this.nodeRadius + 1) * u.y - n.y + (n.y - u.y) * this.arrowSize,
                }, angle);
                rel.pathDrawn.D2 = rotatePoint(center, {
                    x: target.x - source.x - (this.nodeRadius + 1) * u.x,
                    y: target.y - source.y - (this.nodeRadius + 1) * u.y,
                }, angle);
                rel.pathDrawn.E2 = rotatePoint(center, {
                    x: target.x - source.x - (this.nodeRadius + 1) * u.x + (-n.x - u.x) * this.arrowSize,
                    y: target.y - source.y - (this.nodeRadius + 1) * u.y + (-n.y - u.y) * this.arrowSize,
                }, angle);
                rel.pathDrawn.F2 = rotatePoint(center, {
                    x: target.x - source.x - (this.nodeRadius + 1) * u.x - u.x * this.arrowSize,
                    y: target.y - source.y - (this.nodeRadius + 1) * u.y - u.y * this.arrowSize,
                }, angle);
                rel.pathDrawn.G2 = rotatePoint(center, {
                    x: target.x - source.x - textMargin.x,
                    y: target.y - source.y - textMargin.y,
                }, angle);
                const n1 = unitaryNormalVector(source, target, 50);
                rel.pathDrawn.A3 = rotatePoint(center, {
                    x: 0 - n1.x,
                    y: 0 - n1.y,
                }, angle);
                rel.pathDrawn.B3 = rotatePoint(center, {
                    x: target.x - source.x - n1.x,
                    y: target.y - source.y - n1.y,
                }, angle);
                rel.pathDrawn.C3 = rotatePoint(center, {
                    x: target.x - source.x + n1.x - n.x,
                    y: target.y - source.y + n1.y - n.y,
                }, angle);
                rel.pathDrawn.D3 = rotatePoint(center, {
                    x: 0 + n1.x - n.x,
                    y: 0 + n1.y - n.y,
                }, angle);
                rel.textTranslate = rotatePoint(center, {
                    x: (target.x - source.x) * 0.5
                        + n.x * ((rel.rotate > 90 && rel.rotate < 270) ? 2 : -3),
                    y: (target.y - source.y) * 0.5
                        + n.y * ((rel.rotate > 90 && rel.rotate < 270) ? 2 : -3),
                }, angle);
            });
        }).on('end', () => {
            if (this.zoomFit && this.initialLoad) {
                this.initialLoad = false;
                this.zoomSvgScale();
            }
        });
        return simulation;
    }
    reloadSimulation() {
        this.simulation.nodes(this.d3Graph.nodes);
        this.simulation.force('link')
            .links(this.d3Graph.relationships);
        this.simulation.alphaTarget(0).restart();
    }
    zoomSvgScale() {
        const bounds = this.mainCanvas.nativeElement.getBBox();
        if (bounds.width * bounds.height === 0) {
            return; // nothing to fit
        }
        this.canvasViewBox = {
            minX: bounds.x, minY: bounds.y,
            width: bounds.width, height: bounds.height,
        };
    }
    onNodeDragging(e, node) {
        node.fx = e.pointerPosition.x;
        node.fy = e.pointerPosition.y;
    }
    onNodeDragStart(node) {
        if (node.controlledByDragging || node.isLongPressing) {
            return;
        }
        this.simulation.alphaTarget(0.1).restart();
    }
    onNodeDragEnd(e, node) {
        node.controlledByDragging = true;
        this.simulation.alphaTarget(0);
    }
    onNodeClick(e, node) {
        e.stopPropagation();
        if (node.controlledByDragging || node.isLongPressing) {
            node.controlledByDragging = false;
            node.isLongPressing = false;
            return;
        }
        node.fx = node.fy = null;
        if (node.selected) {
            this.selectedNode = null;
            this.transitionService.animate('openClose', 'open', 'void', node)
                .then(_ => node.selected = false);
        }
        else {
            node.selected = true;
            if (this.selectedNode) {
                const previousNode = this.selectedNode;
                this.transitionService
                    .animate('openClose', 'open', 'void', this.selectedNode)
                    .then(_ => previousNode.selected = false);
            }
            this.selectedNode = node;
            this.transitionService.animate('openClose', 'void', 'open', node);
        }
    }
    updateDashedArrowSource(node) {
        this.$states.dashedArrow = { from: node, to: null };
    }
    updateDashedArrowTarget(to) {
        if (!to) {
            // to is empty or removed ==> dashedArrow should not appear
            if (this.$states.dashedArrow && this.$states.dashedArrow.id) {
                const removeId = this.$states.dashedArrow.id;
                this.$states.dashedArrow.id = null;
                this.d3Graph.removeRelationById(removeId);
                this.reloadSimulation();
            }
            if (this.$states.dashedArrow && this.$states.dashedArrow.from) {
                this.$states.dashedArrow.to = null;
                return;
            }
            this.$states.dashedArrow = null;
            return;
        }
        if (this.$states.dashedArrow.from.id === to.id) {
            return;
        }
        if (!this.$states.dashedArrow) {
            this.$states.dashedArrow = { from: null, to };
        }
        else {
            // both from and to suffice dashedArrow appearing
            const regId = nanoid();
            this.$states.dashedArrow.to = to;
            this.$states.dashedArrow.id = regId;
            const source = this.$states.dashedArrow.from.id;
            this.d3Graph.addRelation({
                id: regId, type: 'for',
                source, target: to.id, properties: { from: 1 }
            });
            this.reloadSimulation();
            this.graphUpdated.emit(this.d3Graph);
        }
    }
    clearDashedArrow(ev) {
        this.$states.dashedArrow = null;
    }
    plusDashedArrow(ev) {
        ev.preventDefault();
        this.$states.dashedArrow = null;
    }
    /**
     * TODO: Should be moved into a service
     */
    addNode(node) {
        this.d3Graph.addNode(node);
        this.reloadSimulation();
    }
    updateActiveIndividual(node) {
        this.activeIndividualStore.activeIndividual = node;
    }
    clearActiveIndividual() {
        this.activeIndividualStore.clearActiveIndividual();
    }
    updateViewBox(e) {
        this.canvasViewBox.minX = e.minX;
        this.canvasViewBox.minY = e.minY;
        this.canvasViewBox.width = e.width;
        this.canvasViewBox.height = e.height;
    }
    removeRelation(ev, rel) {
        ev.preventDefault();
        this.d3Graph.removeRelationById(rel.id);
        this.graphUpdated.emit(this.d3Graph);
        this.reloadSimulation();
    }
}
LinkedDataGraphicComponent.decorators = [
    { type: Component, args: [{
                providers: [
                    { provide: TransitionService, useClass: AnimationTranstion, },
                    [PLUS_ICON_PROVIDER, REMOVE_ICON_PROVIDER, UNLOCK_ICON_PROVIDER],
                    SvgIconRegistry
                ],
                selector: 'ngld-canvas',
                template: "<svg #mainCanvas ngldPanZoom class=\"neo4jd3-graph mainCanvas\"\n    [attr.viewBox]=\"canvasViewBox.minX\n                  + ' ' + canvasViewBox.minY\n                  + ' ' + canvasViewBox.width\n                  + ' ' + canvasViewBox.height\"\n    [viewBox]=\"canvasViewBox\"\n    (click)=\"clearDashedArrow($event)\"\n    (viewBoxChanged)=\"updateViewBox($event)\">\n  <g class=\"relationships\">\n    <g *ngFor=\"let rel of d3Graph.relationships\" class=\"relationship\"\n      [attr.transform]=\"'translate(' + rel.source.x + ',' + rel.source.y\n                        +') rotate(' + rel.rotate + ')'\"\n      (click)=\"$states.relationRemove ? removeRelation($event, rel) : null\">\n      <text ngldBoxSizeListener [listenValue]=\"rel.pathDrawn.A1.x\"\n        (boxSize)=\"rel.textBoxSize=$event\"\n        class=\"text\" fill=\"#000000\" font-size=\"8px\" pointer-events=\"none\"\n        text-anchor=\"middle\"\n        [attr.transform]=\"'translate('\n            + rel.textTranslate.x + ',' + rel.textTranslate.y\n            + ') rotate('\n              + ((rel.rotate > 90 && rel.rotate < 270 )? 180:0)\n            + ')'\">\n        {{ rel.type }}\n      </text>\n      <path class=\"outline\" fill=\"#a5abb6\" stroke=\"none\"\n          [attr.d]=\"'M ' + rel.pathDrawn.A1.x + ' ' + rel.pathDrawn.A1.y\n          + ' L ' + rel.pathDrawn.B1.x + ' ' + rel.pathDrawn.B1.y\n          + ' L ' + rel.pathDrawn.C1.x + ' ' + rel.pathDrawn.C1.y\n          + ' L ' + rel.pathDrawn.D1.x + ' ' + rel.pathDrawn.D1.y\n          + ' Z'\n          + ' M ' + rel.pathDrawn.A2.x + ' ' + rel.pathDrawn.A2.y\n          + ' L ' + rel.pathDrawn.B2.x + ' ' + rel.pathDrawn.B2.y\n          + ' L ' + rel.pathDrawn.C2.x + ' ' + rel.pathDrawn.C2.y\n          + ' L ' + rel.pathDrawn.D2.x + ' ' + rel.pathDrawn.D2.y\n          + ' L ' + rel.pathDrawn.E2.x + ' ' + rel.pathDrawn.E2.y\n          + ' L ' + rel.pathDrawn.F2.x + ' ' + rel.pathDrawn.F2.y\n          + ' L ' + rel.pathDrawn.G2.x + ' ' + rel.pathDrawn.G2.y\n          + ' Z'\"></path>\n      <path class=\"overlay\"\n          [attr.d]=\"'M ' + rel.pathDrawn.A3.x + ' ' + rel.pathDrawn.A3.y\n          + ' L ' + rel.pathDrawn.B3.x + ' ' + rel.pathDrawn.B3.y\n          + ' L ' + rel.pathDrawn.C3.x + ' ' + rel.pathDrawn.C3.y\n          + ' L ' + rel.pathDrawn.D3.x + ' ' + rel.pathDrawn.D3.y\n          + ' Z'\"></path>\n    </g>\n  </g>\n  <g class=\"nodes\">\n    <g cdkDrag ngldLongPress ngldPanZoomExclude\n      *ngFor=\"let node of d3Graph.nodes\" class=\"node\" [class.selected]=\"node.selected\"\n      [class.node-highlighted]=\"highlightChecker(node)\"\n      [cdkDragFreeDragPosition]=\"{ x: node.translate.x, y: node.translate.y }\"\n      (cdkDragStarted)=\"onNodeDragStart(node);node.controlledByDragging=true\"\n      (cdkDragEnded)=\"onNodeDragEnd($event, node)\"\n      (cdkDragMoved)=\"onNodeDragging($event, node)\"\n      (longPressing)=\"onNodeDragStart(node);node.isLongPressing=true;node.fx=node.x;node.fy=node.y\"\n      (click)=\"($states.dashedArrow && $states.dashedArrow.id) ? plusDashedArrow($event) : onNodeClick($event, node)\"\n      (mouseenter)=\"$states.dashedArrow ? updateDashedArrowTarget(node) : updateActiveIndividual(node)\"\n      (mouseleave)=\"$states.dashedArrow ? updateDashedArrowTarget(null) : clearActiveIndividual()\">\n      <circle class=\"ring\" [attr.r]=\"nodeRadius * 1.16\">\n        <title> {{ node.labels[0] }} [{{node.id}}] </title>\n      </circle>\n      <circle class=\"outline\" [attr.r]=\"nodeRadius\" [attr.fill]=\"node.color.fill\" [attr.stroke]=\"node.color.stroke\">\n        <title> {{ node.labels[0] }} [{{node.id}}]  </title>\n      </circle>\n      <text class=\"text\" fill=\"#ffffff\" pointer-events=\"none\" y=\"4px\">\n        {{ node.labels.join(' ') }}</text>\n      <ng-container *ngIf=\"node.selected\">\n        <path *ngFor=\"let panelRotate of [0,120,240]\" class=\"context-menu-item\"\n             (click)=\"updateDashedArrowSource(node)\"\n              [attr.transform]=\"'rotate(' + panelRotate + ')'\"\n              [attr.d]=\"'M ' + node.pathDrawn.D1.x + ' ' + node.pathDrawn.D1.y\n                    + ' A ' + node.pathDrawn.R1.outer + ' ' + node.pathDrawn.R1.outer + ' 0 0,1 ' + node.pathDrawn.C1.x + ' ' + node.pathDrawn.C1.y\n                    + ' L ' + node.pathDrawn.B1.x + ' ' + node.pathDrawn.B1.y\n                    + ' A 33 33 0 0,0 ' + node.pathDrawn.A1.x + ' ' + node.pathDrawn.A1.y\n                    + ' Z'\"></path>\n        <g ngld-icon svgIcon=\"unlock_node\" transform=\"translate(-52,-30) scale(0.7)\" color=\"#2A2C34\"></g>\n        <g ngld-icon svgIcon=\"remove_node\" transform=\"translate(33,-24) scale(0.7)\" color=\"#2A2C34\"></g>\n        <g ngld-icon svgIcon=\"plus_node\"\n          (click)=\"updateDashedArrowSource(node)\"\n          transform=\"translate(-8,38) scale(0.7)\" color=\"#2A2C34\"></g>\n      </ng-container>\n    </g>\n  </g>\n\n  <ng-container *ngIf=\"$states.debug\">\n    <path *ngFor=\"let node of d3Graph.nodes\" class=\"outline\" stroke=\"green\" stroke-width=\"1\"\n            [attr.d]=\"'M 0 0 '\n            + ' L ' + node.x + ' ' + node.y\n            + ' Z'\"></path>\n  </ng-container>\n</svg>\n",
                styles: ["svg.mainCanvas{border:1px solid #ddd;border-radius:5px;width:100%;height:100%;cursor:move}path.context-menu-item{stroke-width:2px;fill:#d2d5da;cursor:pointer}path.context-menu-item:hover{fill:#b9b9b9}.node{touch-action:none;-webkit-tap-highlight-color:#fff}.node.node-highlighted .ring{-ms-filter:\"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)\";filter:alpha(opacity=50);opacity:.5;stroke:#888;stroke-width:12px}.node .outline{cursor:pointer;pointer-events:all;stroke-width:2px}.node .ring{fill:none;-ms-filter:\"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)\";filter:alpha(opacity=0);opacity:0;stroke:#6ac6ff;stroke-width:8px}.node .text{font-size:10px;text-anchor:middle}.node .text.icon{font-family:FontAwesome}.node:hover .ring{-ms-filter:\"progid:DXImageTransform.Microsoft.Alpha(Opacity=30)\";filter:alpha(opacity=30);opacity:.3}.node.selected .ring{stroke:#fdcc59;opacity:.4}.relationship{cursor:default}.relationship line{stroke:#aaa}.relationship .outline{cursor:default}.relationship .overlay{cursor:default;fill:#6ac6ff;-ms-filter:\"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)\";filter:alpha(opacity=0);opacity:0}.relationship text{cursor:default}.relationship:hover .overlay{-ms-filter:\"progid:DXImageTransform.Microsoft.Alpha(Opacity=30)\";filter:alpha(opacity=30);opacity:.3}\n"]
            },] }
];
LinkedDataGraphicComponent.ctorParameters = () => [
    { type: TransitionService },
    { type: ColorProviderService, decorators: [{ type: Optional }] },
    { type: ActiveIndividualStoreService, decorators: [{ type: Optional }] }
];
LinkedDataGraphicComponent.propDecorators = {
    mainCanvas: [{ type: ViewChild, args: ['mainCanvas', { static: true },] }],
    nodeRadius: [{ type: Input }],
    arrowSize: [{ type: Input }],
    minCollision: [{ type: Input }],
    zoomFit: [{ type: Input }],
    debug: [{ type: Input }],
    graph: [{ type: Input }],
    relationRemove: [{ type: Input }],
    graphUpdated: [{ type: Output }],
    highlightChecker: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FudmFzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9saWIvY2FudmFzLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxTQUFTLEVBQWMsS0FBSyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUU1SCxPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLGlCQUFpQixFQUFFLE9BQU8sRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ25HLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQzFELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzlELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzlELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFDN0MsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUNoQyxPQUFPLEtBQUssSUFBSSxNQUFNLE1BQU0sQ0FBQztBQUM3QixPQUFPLEVBQWMsZUFBZSxFQUFFLFlBQVksRUFBRSxhQUFhLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBYSxNQUFNLFVBQVUsQ0FBQztBQUN2SCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFakQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ25ELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSwyQkFBMkIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQzdGLE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBQ2pGLE9BQU8sRUFBRSxXQUFXLEVBQUUsUUFBUSxFQUFFLG1CQUFtQixFQUFFLGFB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TSxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsU0FBUztvQkFDcEYsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVM7aUJBQ3JGLEVBQUUsS0FBSyxDQUFDLENBQUM7Z0JBQ1YsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsV0FBVyxDQUFDLE1BQU0sRUFBRTtvQkFDckMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxTQUFTO29CQUMzRSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVM7aUJBQzVFLEVBQUUsS0FBSyxDQUFDLENBQUM7Z0JBQ1YsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsV0FBVyxDQUFDLE1BQU0sRUFBRTtvQkFDckMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsR0FBRyxVQUFVLENBQUMsQ0FBQztvQkFD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QUFxQzs7YUFFdEM7OztZQXhFNkMsaUJBQWlCO1lBV3RELG9CQUFvQix1QkEwR3hCLFFBQVE7WUF6R0osNEJBQTRCLHVCQTBHaEMsUUFBUTs7O3lCQTNDVixTQUFTLFNBQUMsWUFBWSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTt5QkFHeEMsS0FBSzt3QkFDTCxLQUFLOzJCQUNMLEtBQUs7c0JBQ0wsS0FBSztvQkFDTCxLQUFLO29CQUdMLEtBQUs7NkJBR0wsS0FBSzsyQkFJTCxNQUFNOytCQXFCTixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgSW5wdXQsIE9wdGlvbmFsLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ2RrRHJhZ0VuZCwgQ2RrRHJhZ01vdmUgfSBmcm9tICdAYW5ndWxhci9jZGsvZHJhZy1kcm9wJztcbmltcG9ydCB7IEVhc2luZywgdHJpZ2dlciwgdHJhbnNpdGlvbiwgcmVuZGVyLCBUcmFuc2l0aW9uU2VydmljZSwgYW5pbWF0ZSB9IGZyb20gJ0BuZ2xkL3RyYW5zaXRpb24nO1xuaW1wb3J0IHsgUExVU19JQ09OX1BST1ZJREVSIH0gZnJvbSAnQG5nbGQvaWNvbi9wbHVzLmljb24nO1xuaW1wb3J0IHsgUkVNT1ZFX0lDT05fUFJPVklERVIgfSBmcm9tICdAbmdsZC9pY29uL3JlbW92ZS5pY29uJztcbmltcG9ydCB7IFVOTE9DS19JQ09OX1BST1ZJREVSIH0gZnJvbSAnQG5nbGQvaWNvbi91bmxvY2suaWNvbic7XG5pbXBvcnQgeyBTdmdJY29uUmVnaXN0cnkgfSBmcm9tICdAbmdsZC9pY29uJztcbmltcG9ydCB7IG5hbm9pZCB9IGZyb20gJ25hbm9pZCc7XG5pbXBvcnQgKiBhcyByZmRjIGZyb20gJ3JmZGMnO1xuaW1wb3J0IHsgU2ltdWxhdGlvbiwgZm9yY2VTaW11bGF0aW9uLCBmb3JjZUNvbGxpZGUsIGZvcmNlTWFueUJvZHksIGZvcmNlTGluaywgZm9yY2VDZW50ZXIsIEZvcmNlTGluayB9IGZyb20gJ2QzLWZvcmNlJztcbmltcG9ydCB7IGludGVycG9sYXRlWm9vbSB9IGZyb20gJ2QzLWludGVycG9sYXRlJztcbmltcG9ydCB7IFNpbXBsZUdyYXBoLCBEM1JlbGF0aW9uc2hpcCwgRDNOb2RlIH0gZnJvbSAnLi9kYXRhLWludGVyZmFjZSc7XG5pbXBvcnQgeyBHcmFwaENvbnRhaW5lciB9IGZyb20gJy4vZ3JhcGguY29udGFpbmVyJztcbmltcG9ydCB7IENvbG9yUHJvdmlkZXJTZXJ2aWNlLCBEZWZhdWx0Q29sb3JQcm92aWRlclNlcnZpY2UgfSBmcm9tICcuL2NvbG9yLXByb3ZpZGVyLnNlcnZpY2UnO1xuaW1wb3J0IHsgQWN0aXZlSW5kaXZpZHVhbFN0b3JlU2VydmljZSB9IGZyb20gJy4vYWN0aXZlLWluZGl2aWR1YWwtc3RvcmUuc2VydmljZSc7XG5pbXBvcnQgeyByb3RhdGVQb2ludCwgcm90YXRpb24sIHVuaXRhcnlOb3JtYWxWZWN0b3IsIHVuaXRhcnlWZWN0b3IgfSBmcm9tICcuL3V0aWxzJztcblxuY29uc3QgY2xvbmUgPSByZmRjKCk7XG5cbmNvbnN0IGludGVycG9sYXRlUmFkaXVzID0gaW50ZXJwb2xhdGVab29tKFswLCAwLCAzM10sIFswLCAwLCA2Nl0pO1xuY29uc3QgY29zaW5lU3RhcnQgPSBNYXRoLmNvcygyICogTWF0aC5QSSAvIDE4MCk7XG5jb25zdCBzaW5lU3RhcnQgPSBNYXRoLnNpbigyICogTWF0aC5QSSAvIDE4MCk7XG5jb25zdCBjb3NpbmVFbmQgPSBNYXRoLmNvcygxMjAgKiBNYXRoLlBJIC8gMTgwKTtcbmNvbnN0IHNpbmVFbmQgPSBNYXRoLnNpbigxMjAgKiBNYXRoLlBJIC8gMTgwKTtcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIEFuaW1hdGlvblRyYW5zdGlvbiBleHRlbmRzIFRyYW5zaXRpb25TZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoW1xuICAgICAgdHJpZ2dlcignb3BlbkNsb3NlJywgW1xuICAgICAgICB0cmFuc2l0aW9uKChmcm9tLCB0bykgPT4gZnJvbSA9PT0gJ3ZvaWQnICYmIHRvID09PSAnb3BlbicsIFtcbiAgICAgICAgICByZW5kZXI8R3JhcGhDb250YWluZXJbJ25vZGVzJ11bMF0+KChwLCBub2RlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByYWRpdXNPdXRlciA9IGludGVycG9sYXRlUmFkaXVzKHApWzJdO1xuICAgICAgICAgICAgLy8gc2luKDIpICogMzMsIGNvcygyKSAqIDMzXG4gICAgICAgICAgICBub2RlLnBhdGhEcmF3bi5BMSA9IHsgeDogc2luZVN0YXJ0ICogMzMsIHk6IC0gY29zaW5lU3RhcnQgKiAzMyB9O1xuICAgICAgICAgICAgLy8gc2luKDEyMCkgKiAzMywgY29zKDEyMCkgKiAzM1xuICAgICAgICAgICAgbm9kZS5wYXRoRHJhd24uQjEgPSB7IHg6IHNpbmVFbmQgKiAzMywgeTogLSBjb3NpbmVFbmQgKiAzMyB9O1xuICAgICAgICAgICAgLy8gc2luKDEyMCkgKiA2MywgY29zKDEyMCkgKiA2M1xuICAgICAgICAgICAgbm9kZS5wYXRoRHJhd24uQzEgPSB7IHg6IHNpbmVFbmQgKiByYWRpdXNPdXRlciwgeTogLSBjb3NpbmVFbmQgKiByYWRpdXNPdXRlciB9O1xuICAgICAgICAgICAgLy8gc2luKDIpICogNjMsIGNvcygyKSAqIDYzXG4gICAgICAgICAgICBub2RlLnBhdGhEcmF3bi5EMSA9IHsgeDogc2luZVN0YXJ0ICogcmFkaXVzT3V0ZXIsIHk6IC0gY29zaW5lU3RhcnQgKiByYWRpdXNPdXRlciB9O1xuICAgICAgICAgICAgbm9kZS5wYXRoRHJhd24uUjEub3V0ZXIgPSByYWRpdXNPdXRlcjtcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBhbmltYXRlKDIwMCwgRWFzaW5nLmVhc2VJbkN1YmljKSxcbiAgICAgICAgXSksXG4gICAgICAgIHRyYW5zaXRpb24oKGZyb20sIHRvKSA9PiBmcm9tID09PSAnb3BlbicgJiYgdG8gPT09ICd2b2lkJywgW1xuICAgICAgICAgIHJlbmRlcjxHcmFwaENvbnRhaW5lclsnbm9kZXMnXVswXT4oKHAsIG5vZGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJhZGl1c091dGVyID0gaW50ZXJwb2xhdGVSYWRpdXMoMSAtIHApWzJdO1xuICAgICAgICAgICAgLy8gc2luKDIpICogMzMsIGNvcygyKSAqIDMzXG4gICAgICAgICAgICBub2RlLnBhdGhEcmF3bi5BMSA9IHsgeDogc2luZVN0YXJ0ICogMzMsIHk6IC0gY29zaW5lU3RhcnQgKiAzMyB9O1xuICAgICAgICAgICAgLy8gc2luKDEyMCkgKiAzMywgY29zKDEyMCkgKiAzM1xuICAgICAgICAgICAgbm9kZS5wYXRoRHJhd24uQjEgPSB7IHg6IHNpbmVFbmQgKiAzMywgeTogLSBjb3NpbmVFbmQgKiAzMyB9O1xuICAgICAgICAgICAgLy8gc2luKDEyMCkgKiA2MywgY29zKDEyMCkgKiA2M1xuICAgICAgICAgICAgbm9kZS5wYXRoRHJhd24uQzEgPSB7IHg6IHNpbmVFbmQgKiByYWRpdXNPdXRlciwgeTogLSBjb3NpbmVFbmQgKiByYWRpdXNPdXRlciB9O1xuICAgICAgICAgICAgLy8gc2luKDIpICogNjMsIGNvcygyKSAqIDYzXG4gICAgICAgICAgICBub2RlLnBhdGhEcmF3bi5EMSA9IHsgeDogc2luZVN0YXJ0ICogcmFkaXVzT3V0ZXIsIHk6IC0gY29zaW5lU3RhcnQgKiByYWRpdXNPdXRlciB9O1xuICAgICAgICAgICAgbm9kZS5wYXRoRHJhd24uUjEub3V0ZXIgPSByYWRpdXNPdXRlcjtcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBhbmltYXRlKDIwMCwgRWFzaW5nLmVhc2VPdXRDdWJpYyksXG4gICAgICAgIF0pLFxuICAgICAgXSksXG4gICAgXSk7XG4gIH1cbn1cblxuQENvbXBvbmVudCh7XG4gIHByb3ZpZGVyczogW1xuICAgIHsgcHJvdmlkZTogVHJhbnNpdGlvblNlcnZpY2UsIHVzZUNsYXNzOiBBbmltYXRpb25UcmFuc3Rpb24sIH0sXG4gICAgW1BMVVNfSUNPTl9QUk9WSURFUiwgUkVNT1ZFX0lDT05fUFJPVklERVIsIFVOTE9DS19JQ09OX1BST1ZJREVSXSxcbiAgICBTdmdJY29uUmVnaXN0cnlcbiAgXSxcbiAgc2VsZWN0b3I6ICduZ2xkLWNhbnZhcycsXG4gIHRlbXBsYXRlVXJsOiAnLi9jYW52YXMuY29tcG9uZW50LnN2ZycsXG4gIHN0eWxlVXJsczogWycuL2NhbnZhcy5zY3NzJ10sXG59KVxuZXhwb3J0IGNsYXNzIExpbmtlZERhdGFHcmFwaGljQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICBAVmlld0NoaWxkKCdtYWluQ2FudmFzJywgeyBzdGF0aWM6IHRydWUgfSlcbiAgbWFpbkNhbnZhczogRWxlbWVudFJlZjxTVkdTVkdFbGVtZW50PjtcblxuICBASW5wdXQoKSBub2RlUmFkaXVzID0gMjU7XG4gIEBJbnB1dCgpIGFycm93U2l6ZSA9IDQ7XG4gIEBJbnB1dCgpIG1pbkNvbGxpc2lvbiA9IDYwO1xuICBASW5wdXQoKSB6b29tRml0ID0gZmFsc2U7XG4gIEBJbnB1dCgpIHNldCBkZWJ1ZyhzdGF0ZTogYm9vbGVhbikge1xuICAgIHRoaXMuJHN0YXRlcy5kZWJ1ZyA9IHN0YXRlO1xuICB9XG4gIEBJbnB1dCgpIHNldCBncmFwaChnOiBTaW1wbGVHcmFwaCkge1xuICAgIHRoaXMuaW5pdEdyYXBoID0gZztcbiAgfVxuICBASW5wdXQoKSBzZXQgcmVsYXRpb25SZW1vdmUoc3RhdGU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLiRzdGF0ZXMucmVsYXRpb25SZW1vdmUgPSBzdGF0ZTtcbiAgfVxuXG4gIEBPdXRwdXQoKSBncmFwaFVwZGF0ZWQgPSBuZXcgRXZlbnRFbWl0dGVyPFNpbXBsZUdyYXBoPigpO1xuXG4gICRzdGF0ZXMgPSB7XG4gICAgZGVidWc6IGZhbHNlLFxuICAgIGRhc2hlZEFycm93OiBudWxsIGFzIHsgZnJvbTogRDNOb2RlLCB0bzogRDNOb2RlLCBpZD86IHN0cmluZyB9LFxuICAgIHJlbGF0aW9uUmVtb3ZlOiBmYWxzZSxcbiAgfTtcbiAgZDNHcmFwaDogR3JhcGhDb250YWluZXI7XG5cbiAgY2FudmFzVmlld0JveCA9IHtcbiAgICBtaW5YOiAwLFxuICAgIG1pblk6IDAsXG4gICAgd2lkdGg6IDgwMCxcbiAgICBoZWlnaHQ6IDUwMCxcbiAgfTtcblxuICBwcml2YXRlIHNpbXVsYXRpb246IFNpbXVsYXRpb248RDNOb2RlLCBEM1JlbGF0aW9uc2hpcD47XG4gIHByaXZhdGUgaW5pdEdyYXBoOiBTaW1wbGVHcmFwaDtcbiAgcHJpdmF0ZSBpbml0aWFsTG9hZCA9IHRydWU7XG4gIHByaXZhdGUgc2VsZWN0ZWROb2RlOiBHcmFwaENvbnRhaW5lclsnbm9kZXMnXVswXTtcblxuICBASW5wdXQoKSBoaWdobGlnaHRDaGVja2VyID0gKG5vZGU6IEQzTm9kZSkgPT4gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSB0cmFuc2l0aW9uU2VydmljZTogVHJhbnNpdGlvblNlcnZpY2UsXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBjb2xvclByb3ZpZGVyOiBDb2xvclByb3ZpZGVyU2VydmljZSxcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGFjdGl2ZUluZGl2aWR1YWxTdG9yZTogQWN0aXZlSW5kaXZpZHVhbFN0b3JlU2VydmljZSxcbiAgKSB7XG4gICAgaWYgKCF0aGlzLmFjdGl2ZUluZGl2aWR1YWxTdG9yZSkge1xuICAgICAgdGhpcy5hY3RpdmVJbmRpdmlkdWFsU3RvcmUgPSBuZXcgQWN0aXZlSW5kaXZpZHVhbFN0b3JlU2VydmljZSgpO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuY29sb3JQcm92aWRlcikge1xuICAgICAgdGhpcy5jb2xvclByb3ZpZGVyID0gbmV3IERlZmF1bHRDb2xvclByb3ZpZGVyU2VydmljZSgpO1xuICAgIH1cbiAgICB0aGlzLmQzR3JhcGggPSBuZXcgR3JhcGhDb250YWluZXIodGhpcy5jb2xvclByb3ZpZGVyKTtcbiAgfVxuXG4gIGFzeW5jIG5nT25Jbml0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuc2ltdWxhdGlvbiA9IHRoaXMubmV3U2ltdWxhdGlvbigpO1xuICAgIHRoaXMuaW5pdEdyYXBoLm5vZGVzLmZvckVhY2gobm9kZSA9PiB0aGlzLmQzR3JhcGguYWRkTm9kZShjbG9uZShub2RlKSkpO1xuICAgIHRoaXMuaW5pdEdyYXBoLnJlbGF0aW9uc2hpcHMuZm9yRWFjaChyZWwgPT4gdGhpcy5kM0dyYXBoLmFkZFJlbGF0aW9uKGNsb25lKHJlbCkpKTtcbiAgICB0aGlzLnJlbG9hZFNpbXVsYXRpb24oKTtcbiAgICBjb25zdCBtYWluQ2FudmFzU2l6ZSA9IHRoaXMuZ2V0TWFpbkNhbnZhc1NpemUoKTtcbiAgICB0aGlzLmNhbnZhc1ZpZXdCb3ggPSB7XG4gICAgICBtaW5YOiAwLCBtaW5ZOiAwLCB3aWR0aDogbWFpbkNhbnZhc1NpemUud2lkdGgsIGhlaWdodDogbWFpbkNhbnZhc1NpemUuaGVpZ2h0LFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGdldE1haW5DYW52YXNTaXplKCk6IHsgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIgfSB7XG4gICAgcmV0dXJuIHRoaXMubWFpbkNhbnZhcy5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICB9XG5cbiAgcHJpdmF0ZSBuZXdTaW11bGF0aW9uKCk6IFNpbXVsYXRpb248RDNOb2RlLCBEM1JlbGF0aW9uc2hpcD4ge1xuICAgIGNvbnN0IHNpbXVsYXRpb24gPSBmb3JjZVNpbXVsYXRpb248RDNOb2RlLCBEM1JlbGF0aW9uc2hpcD4oKTtcbiAgICBjb25zdCBtYWluQ2FudmFzU2l6ZSA9IHRoaXMuZ2V0TWFpbkNhbnZhc1NpemUoKTtcbiAgICBzaW11bGF0aW9uXG4gICAgICAuZm9yY2UoJ2NvbGxpZGUnLCBmb3JjZUNvbGxpZGUoKVxuICAgICAgICAucmFkaXVzKGQgPT4gdGhpcy5taW5Db2xsaXNpb24pLml0ZXJhdGlvbnMoMikpXG4gICAgICAuZm9yY2UoJ2NoYXJnZScsIGZvcmNlTWFueUJvZHkoKSlcbiAgICAgIC5mb3JjZSgnbGluaycsIGZvcmNlTGluazxEM05vZGUsIEQzUmVsYXRpb25zaGlwPigpLmlkKGQgPT4gZC5pZCArICcnKSlcbiAgICAgIC5mb3JjZSgnY2VudGVyJywgZm9yY2VDZW50ZXIobWFpbkNhbnZhc1NpemUud2lkdGggLyAyLCBtYWluQ2FudmFzU2l6ZS5oZWlnaHQgLyAyKSlcbiAgICAgIC5vbigndGljaycsICgpID0+IHtcbiAgICAgICAgdGhpcy5kM0dyYXBoLm5vZGVzLmZvckVhY2gobm9kZSA9PiB7XG4gICAgICAgICAgaWYgKCFub2RlLmNvbnRyb2xsZWRCeURyYWdnaW5nKSB7XG4gICAgICAgICAgICBub2RlLnRyYW5zbGF0ZS54ID0gbm9kZS54O1xuICAgICAgICAgICAgbm9kZS50cmFuc2xhdGUueSA9IG5vZGUueTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmQzR3JhcGgucmVsYXRpb25zaGlwcy5mb3JFYWNoKHJlbCA9PiB7XG4gICAgICAgICAgY29uc3QgY2VudGVyID0geyB4OiAwLCB5OiAwIH07XG4gICAgICAgICAgY29uc3Qgc291cmNlID0gcmVsLnNvdXJjZSBhcyBEM05vZGU7XG4gICAgICAgICAgY29uc3QgdGFyZ2V0ID0gcmVsLnRhcmdldCBhcyBEM05vZGU7XG4gICAgICAgICAgY29uc3QgYW5nbGUgPSByb3RhdGlvbihzb3VyY2UsIHRhcmdldCk7XG4gICAgICAgICAgcmVsLnJvdGF0ZSA9IHJvdGF0aW9uKHNvdXJjZSwgcmVsLnRhcmdldCBhcyBEM05vZGUpO1xuICAgICAgICAgIC8vIFtTT1VSQ0VdIC0tdGV4dE1hcmdpbi0tW1RFWFRdLS10ZXh0TWFyZ2luLS0+W1RBUkdFVF1cbiAgICAgICAgICAvLyBbU09VUkNFXSAtLXRleHRNYXJnaW4tLXRleHRNYXJnaW4tLVtURVhUXS0tPltUQVJHRVRdXG4gICAgICAgICAgLy8gLS10ZXh0TWFyZ2luLS10ZXh0TWFyZ2luLS1bVEVYVF0tLSA9IFtTT1VSQ0VdLS0+W1RBUkdFVF1cbiAgICAgICAgICBjb25zdCBuID0gdW5pdGFyeU5vcm1hbFZlY3Rvcihzb3VyY2UsIHRhcmdldCk7XG4gICAgICAgICAgY29uc3QgdSA9IHVuaXRhcnlWZWN0b3Ioc291cmNlLCB0YXJnZXQpO1xuICAgICAgICAgIGNvbnN0IHRleHRNYXJnaW4gPSB7XG4gICAgICAgICAgICB5OiAodGFyZ2V0LnkgLSBzb3VyY2UueSAtIChyZWwudGV4dEJveFNpemUud2lkdGggKyAxMCkgKiB1LnkpICogMC41LFxuICAgICAgICAgICAgeDogKHRhcmdldC54IC0gc291cmNlLnggLSAocmVsLnRleHRCb3hTaXplLndpZHRoICsgMTApICogdS54KSAqIDAuNSxcbiAgICAgICAgICB9O1xuICAgICAgICAgIC8vID0+IHUgaXMgc2ltcGxlIHNjYWxlIG9mIHRleHRNYXJnaW5cbiAgICAgICAgICAvLyA9PiBuIGlzIHBlcnBlbmRpY3VsYXIgdG8gdGV4dE1hcmdpblxuICAgICAgICAgIHJlbC5wYXRoRHJhd24uQTEgPSByb3RhdGVQb2ludChjZW50ZXIsIHtcbiAgICAgICAgICAgIHg6IDAgKyAodGhpcy5ub2RlUmFkaXVzICsgMSkgKiB1LnggLSBuLngsXG4gICAgICAgICAgICB5OiAwICsgKHRoaXMubm9kZVJhZGl1cyArIDEpICogdS55IC0gbi55LFxuICAgICAgICAgIH0sIGFuZ2xlKTtcbiAgICAgICAgICByZWwucGF0aERyYXduLkIxID0gcm90YXRlUG9pbnQoY2VudGVyLCB7XG4gICAgICAgICAgICB4OiB0ZXh0TWFyZ2luLnggLSBuLngsXG4gICAgICAgICAgICB5OiB0ZXh0TWFyZ2luLnkgLSBuLnksXG4gICAgICAgICAgfSwgYW5nbGUpO1xuICAgICAgICAgIHJlbC5wYXRoRHJhd24uQzEgPSByb3RhdGVQb2ludChjZW50ZXIsIHtcbiAgICAgICAgICAgIHg6IHRleHRNYXJnaW4ueCxcbiAgICAgICAgICAgIHk6IHRleHRNYXJnaW4ueSxcbiAgICAgICAgICB9LCBhbmdsZSk7XG4gICAgICAgICAgcmVsLnBhdGhEcmF3bi5EMSA9IHJvdGF0ZVBvaW50KGNlbnRlciwge1xuICAgICAgICAgICAgeDogMCArICh0aGlzLm5vZGVSYWRpdXMgKyAxKSAqIHUueCxcbiAgICAgICAgICAgIHk6IDAgKyAodGhpcy5ub2RlUmFkaXVzICsgMSkgKiB1LnksXG4gICAgICAgICAgfSwgYW5nbGUpO1xuICAgICAgICAgIC8vIGxlbmd0aChDLUIpID0gbGVuZ3RoKEQtQSkgPSBsZW5ndGgobikgPSAxXG4gICAgICAgICAgcmVsLnBhdGhEcmF3bi5BMiA9IHJvdGF0ZVBvaW50KGNlbnRlciwge1xuICAgICAgICAgICAgeDogdGFyZ2V0LnggLSBzb3VyY2UueCAtIHRleHRNYXJnaW4ueCAtIG4ueCxcbiAgICAgICAgICAgIHk6IHRhcmdldC55IC0gc291cmNlLnkgLSB0ZXh0TWFyZ2luLnkgLSBuLnksXG4gICAgICAgICAgfSwgYW5nbGUpO1xuICAgICAgICAgIHJlbC5wYXRoRHJhd24uQjIgPSByb3RhdGVQb2ludChjZW50ZXIsIHtcbiAgICAgICAgICAgIHg6IHRhcmdldC54IC0gc291cmNlLnggLSAodGhpcy5ub2RlUmFkaXVzICsgMSkgKiB1LnggLSBuLnggLSB1LnggKiB0aGlzLmFycm93U2l6ZSxcbiAgICAgICAgICAgIHk6IHRhcmdldC55IC0gc291cmNlLnkgLSAodGhpcy5ub2RlUmFkaXVzICsgMSkgKiB1LnkgLSBuLnkgLSB1LnkgKiB0aGlzLmFycm93U2l6ZSxcbiAgICAgICAgICB9LCBhbmdsZSk7XG4gICAgICAgICAgcmVsLnBhdGhEcmF3bi5DMiA9IHJvdGF0ZVBvaW50KGNlbnRlciwge1xuICAgICAgICAgICAgeDogdGFyZ2V0LnggLSBzb3VyY2UueCAtICh0aGlzLm5vZGVSYWRpdXMgKyAxKSAqIHUueCAtIG4ueCArIChuLnggLSB1LngpICogdGhpcy5hcnJvd1NpemUsXG4gICAgICAgICAgICB5OiB0YXJnZXQueSAtIHNvdXJjZS55IC0gKHRoaXMubm9kZVJhZGl1cyArIDEpICogdS55IC0gbi55ICsgKG4ueSAtIHUueSkgKiB0aGlzLmFycm93U2l6ZSxcbiAgICAgICAgICB9LCBhbmdsZSk7XG4gICAgICAgICAgcmVsLnBhdGhEcmF3bi5EMiA9IHJvdGF0ZVBvaW50KGNlbnRlciwge1xuICAgICAgICAgICAgeDogdGFyZ2V0LnggLSBzb3VyY2UueCAtICh0aGlzLm5vZGVSYWRpdXMgKyAxKSAqIHUueCxcbiAgICAgICAgICAgIHk6IHRhcmdldC55IC0gc291cmNlLnkgLSAodGhpcy5ub2RlUmFkaXVzICsgMSkgKiB1LnksXG4gICAgICAgICAgfSwgYW5nbGUpO1xuICAgICAgICAgIHJlbC5wYXRoRHJhd24uRTIgPSByb3RhdGVQb2ludChjZW50ZXIsIHtcbiAgICAgICAgICAgIHg6IHRhcmdldC54IC0gc291cmNlLnggLSAodGhpcy5ub2RlUmFkaXVzICsgMSkgKiB1LnggKyAoLW4ueCAtIHUueCkgKiB0aGlzLmFycm93U2l6ZSxcbiAgICAgICAgICAgIHk6IHRhcmdldC55IC0gc291cmNlLnkgLSAodGhpcy5ub2RlUmFkaXVzICsgMSkgKiB1LnkgKyAoLW4ueSAtIHUueSkgKiB0aGlzLmFycm93U2l6ZSxcbiAgICAgICAgICB9LCBhbmdsZSk7XG4gICAgICAgICAgcmVsLnBhdGhEcmF3bi5GMiA9IHJvdGF0ZVBvaW50KGNlbnRlciwge1xuICAgICAgICAgICAgeDogdGFyZ2V0LnggLSBzb3VyY2UueCAtICh0aGlzLm5vZGVSYWRpdXMgKyAxKSAqIHUueCAtIHUueCAqIHRoaXMuYXJyb3dTaXplLFxuICAgICAgICAgICAgeTogdGFyZ2V0LnkgLSBzb3VyY2UueSAtICh0aGlzLm5vZGVSYWRpdXMgKyAxKSAqIHUueSAtIHUueSAqIHRoaXMuYXJyb3dTaXplLFxuICAgICAgICAgIH0sIGFuZ2xlKTtcbiAgICAgICAgICByZWwucGF0aERyYXduLkcyID0gcm90YXRlUG9pbnQoY2VudGVyLCB7XG4gICAgICAgICAgICB4OiB0YXJnZXQueCAtIHNvdXJjZS54IC0gdGV4dE1hcmdpbi54LFxuICAgICAgICAgICAgeTogdGFyZ2V0LnkgLSBzb3VyY2UueSAtIHRleHRNYXJnaW4ueSxcbiAgICAgICAgICB9LCBhbmdsZSk7XG4gICAgICAgICAgY29uc3QgbjEgPSB1bml0YXJ5Tm9ybWFsVmVjdG9yKHNvdXJjZSwgdGFyZ2V0LCA1MCk7XG4gICAgICAgICAgcmVsLnBhdGhEcmF3bi5BMyA9IHJvdGF0ZVBvaW50KGNlbnRlciwge1xuICAgICAgICAgICAgeDogMCAtIG4xLngsXG4gICAgICAgICAgICB5OiAwIC0gbjEueSxcbiAgICAgICAgICB9LCBhbmdsZSk7XG4gICAgICAgICAgcmVsLnBhdGhEcmF3bi5CMyA9IHJvdGF0ZVBvaW50KGNlbnRlciwge1xuICAgICAgICAgICAgeDogdGFyZ2V0LnggLSBzb3VyY2UueCAtIG4xLngsXG4gICAgICAgICAgICB5OiB0YXJnZXQueSAtIHNvdXJjZS55IC0gbjEueSxcbiAgICAgICAgICB9LCBhbmdsZSk7XG4gICAgICAgICAgcmVsLnBhdGhEcmF3bi5DMyA9IHJvdGF0ZVBvaW50KGNlbnRlciwge1xuICAgICAgICAgICAgeDogdGFyZ2V0LnggLSBzb3VyY2UueCArIG4xLnggLSBuLngsXG4gICAgICAgICAgICB5OiB0YXJnZXQueSAtIHNvdXJjZS55ICsgbjEueSAtIG4ueSxcbiAgICAgICAgICB9LCBhbmdsZSk7XG4gICAgICAgICAgcmVsLnBhdGhEcmF3bi5EMyA9IHJvdGF0ZVBvaW50KGNlbnRlciwge1xuICAgICAgICAgICAgeDogMCArIG4xLnggLSBuLngsXG4gICAgICAgICAgICB5OiAwICsgbjEueSAtIG4ueSxcbiAgICAgICAgICB9LCBhbmdsZSk7XG4gICAgICAgICAgcmVsLnRleHRUcmFuc2xhdGUgPSByb3RhdGVQb2ludChjZW50ZXIsIHtcbiAgICAgICAgICAgIHg6ICh0YXJnZXQueCAtIHNvdXJjZS54KSAqIDAuNVxuICAgICAgICAgICAgICArIG4ueCAqICgocmVsLnJvdGF0ZSA+IDkwICYmIHJlbC5yb3RhdGUgPCAyNzApID8gMiA6IC0zKSxcbiAgICAgICAgICAgIHk6ICh0YXJnZXQueSAtIHNvdXJjZS55KSAqIDAuNVxuICAgICAgICAgICAgICArIG4ueSAqICgocmVsLnJvdGF0ZSA+IDkwICYmIHJlbC5yb3RhdGUgPCAyNzApID8gMiA6IC0zKSxcbiAgICAgICAgICB9LCBhbmdsZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSkub24oJ2VuZCcsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuem9vbUZpdCAmJiB0aGlzLmluaXRpYWxMb2FkKSB7XG4gICAgICAgICAgdGhpcy5pbml0aWFsTG9hZCA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuem9vbVN2Z1NjYWxlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIHJldHVybiBzaW11bGF0aW9uO1xuICB9XG5cbiAgcHJpdmF0ZSByZWxvYWRTaW11bGF0aW9uKCk6IHZvaWQge1xuICAgIHRoaXMuc2ltdWxhdGlvbi5ub2Rlcyh0aGlzLmQzR3JhcGgubm9kZXMpO1xuICAgIHRoaXMuc2ltdWxhdGlvbi5mb3JjZTxGb3JjZUxpbms8RDNOb2RlLCBEM1JlbGF0aW9uc2hpcD4+KCdsaW5rJylcbiAgICAgIC5saW5rcyh0aGlzLmQzR3JhcGgucmVsYXRpb25zaGlwcyk7XG4gICAgdGhpcy5zaW11bGF0aW9uLmFscGhhVGFyZ2V0KDApLnJlc3RhcnQoKTtcbiAgfVxuXG4gIHByaXZhdGUgem9vbVN2Z1NjYWxlKCk6IHZvaWQge1xuICAgIGNvbnN0IGJvdW5kcyA9IHRoaXMubWFpbkNhbnZhcy5uYXRpdmVFbGVtZW50LmdldEJCb3goKTtcbiAgICBpZiAoYm91bmRzLndpZHRoICogYm91bmRzLmhlaWdodCA9PT0gMCkge1xuICAgICAgcmV0dXJuOyAvLyBub3RoaW5nIHRvIGZpdFxuICAgIH1cbiAgICB0aGlzLmNhbnZhc1ZpZXdCb3ggPSB7XG4gICAgICBtaW5YOiBib3VuZHMueCwgbWluWTogYm91bmRzLnksXG4gICAgICB3aWR0aDogYm91bmRzLndpZHRoLCBoZWlnaHQ6IGJvdW5kcy5oZWlnaHQsXG4gICAgfTtcbiAgfVxuXG4gIG9uTm9kZURyYWdnaW5nKGU6IENka0RyYWdNb3ZlLCBub2RlOiBHcmFwaENvbnRhaW5lclsnbm9kZXMnXVswXSk6IHZvaWQge1xuICAgIG5vZGUuZnggPSBlLnBvaW50ZXJQb3NpdGlvbi54O1xuICAgIG5vZGUuZnkgPSBlLnBvaW50ZXJQb3NpdGlvbi55O1xuICB9XG5cbiAgb25Ob2RlRHJhZ1N0YXJ0KG5vZGU6IEdyYXBoQ29udGFpbmVyWydub2RlcyddWzBdKTogdm9pZCB7XG4gICAgaWYgKG5vZGUuY29udHJvbGxlZEJ5RHJhZ2dpbmcgfHwgbm9kZS5pc0xvbmdQcmVzc2luZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNpbXVsYXRpb24uYWxwaGFUYXJnZXQoMC4xKS5yZXN0YXJ0KCk7XG4gIH1cblxuICBvbk5vZGVEcmFnRW5kKGU6IENka0RyYWdFbmQsIG5vZGU6IEdyYXBoQ29udGFpbmVyWydub2RlcyddWzBdKTogdm9pZCB7XG4gICAgbm9kZS5jb250cm9sbGVkQnlEcmFnZ2luZyA9IHRydWU7XG4gICAgdGhpcy5zaW11bGF0aW9uLmFscGhhVGFyZ2V0KDApO1xuICB9XG5cbiAgb25Ob2RlQ2xpY2soZTogTW91c2VFdmVudCwgbm9kZTogR3JhcGhDb250YWluZXJbJ25vZGVzJ11bMF0pOiB2b2lkIHtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGlmIChub2RlLmNvbnRyb2xsZWRCeURyYWdnaW5nIHx8IG5vZGUuaXNMb25nUHJlc3NpbmcpIHtcbiAgICAgIG5vZGUuY29udHJvbGxlZEJ5RHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgIG5vZGUuaXNMb25nUHJlc3NpbmcgPSBmYWxzZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbm9kZS5meCA9IG5vZGUuZnkgPSBudWxsO1xuICAgIGlmIChub2RlLnNlbGVjdGVkKSB7XG4gICAgICB0aGlzLnNlbGVjdGVkTm9kZSA9IG51bGw7XG4gICAgICB0aGlzLnRyYW5zaXRpb25TZXJ2aWNlLmFuaW1hdGUoJ29wZW5DbG9zZScsICdvcGVuJywgJ3ZvaWQnLCBub2RlKVxuICAgICAgICAudGhlbihfID0+IG5vZGUuc2VsZWN0ZWQgPSBmYWxzZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5vZGUuc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWROb2RlKSB7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzTm9kZSA9IHRoaXMuc2VsZWN0ZWROb2RlO1xuICAgICAgICB0aGlzLnRyYW5zaXRpb25TZXJ2aWNlXG4gICAgICAgICAgLmFuaW1hdGUoJ29wZW5DbG9zZScsICdvcGVuJywgJ3ZvaWQnLCB0aGlzLnNlbGVjdGVkTm9kZSlcbiAgICAgICAgICAudGhlbihfID0+IHByZXZpb3VzTm9kZS5zZWxlY3RlZCA9IGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuc2VsZWN0ZWROb2RlID0gbm9kZTtcbiAgICAgIHRoaXMudHJhbnNpdGlvblNlcnZpY2UuYW5pbWF0ZSgnb3BlbkNsb3NlJywgJ3ZvaWQnLCAnb3BlbicsIG5vZGUpO1xuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZURhc2hlZEFycm93U291cmNlKG5vZGU6IEdyYXBoQ29udGFpbmVyWydub2RlcyddWzBdKTogdm9pZCB7XG4gICAgdGhpcy4kc3RhdGVzLmRhc2hlZEFycm93ID0geyBmcm9tOiBub2RlLCB0bzogbnVsbCB9O1xuICB9XG5cbiAgdXBkYXRlRGFzaGVkQXJyb3dUYXJnZXQodG86IEdyYXBoQ29udGFpbmVyWydub2RlcyddWzBdKTogdm9pZCB7XG4gICAgaWYgKCF0bykge1xuICAgICAgLy8gdG8gaXMgZW1wdHkgb3IgcmVtb3ZlZCA9PT4gZGFzaGVkQXJyb3cgc2hvdWxkIG5vdCBhcHBlYXJcbiAgICAgIGlmICh0aGlzLiRzdGF0ZXMuZGFzaGVkQXJyb3cgJiYgdGhpcy4kc3RhdGVzLmRhc2hlZEFycm93LmlkKSB7XG4gICAgICAgIGNvbnN0IHJlbW92ZUlkID0gdGhpcy4kc3RhdGVzLmRhc2hlZEFycm93LmlkO1xuICAgICAgICB0aGlzLiRzdGF0ZXMuZGFzaGVkQXJyb3cuaWQgPSBudWxsO1xuICAgICAgICB0aGlzLmQzR3JhcGgucmVtb3ZlUmVsYXRpb25CeUlkKHJlbW92ZUlkKTtcbiAgICAgICAgdGhpcy5yZWxvYWRTaW11bGF0aW9uKCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy4kc3RhdGVzLmRhc2hlZEFycm93ICYmIHRoaXMuJHN0YXRlcy5kYXNoZWRBcnJvdy5mcm9tKSB7XG4gICAgICAgIHRoaXMuJHN0YXRlcy5kYXNoZWRBcnJvdy50byA9IG51bGw7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuJHN0YXRlcy5kYXNoZWRBcnJvdyA9IG51bGw7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLiRzdGF0ZXMuZGFzaGVkQXJyb3cuZnJvbS5pZCA9PT0gdG8uaWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCF0aGlzLiRzdGF0ZXMuZGFzaGVkQXJyb3cpIHtcbiAgICAgIHRoaXMuJHN0YXRlcy5kYXNoZWRBcnJvdyA9IHsgZnJvbTogbnVsbCwgdG8gfTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gYm90aCBmcm9tIGFuZCB0byBzdWZmaWNlIGRhc2hlZEFycm93IGFwcGVhcmluZ1xuICAgICAgY29uc3QgcmVnSWQgPSBuYW5vaWQoKTtcbiAgICAgIHRoaXMuJHN0YXRlcy5kYXNoZWRBcnJvdy50byA9IHRvO1xuICAgICAgdGhpcy4kc3RhdGVzLmRhc2hlZEFycm93LmlkID0gcmVnSWQ7XG4gICAgICBjb25zdCBzb3VyY2UgPSB0aGlzLiRzdGF0ZXMuZGFzaGVkQXJyb3cuZnJvbS5pZDtcbiAgICAgIHRoaXMuZDNHcmFwaC5hZGRSZWxhdGlvbih7XG4gICAgICAgIGlkOiByZWdJZCwgdHlwZTogJ2ZvcicsXG4gICAgICAgIHNvdXJjZSwgdGFyZ2V0OiB0by5pZCwgcHJvcGVydGllczogeyBmcm9tOiAxIH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5yZWxvYWRTaW11bGF0aW9uKCk7XG4gICAgICB0aGlzLmdyYXBoVXBkYXRlZC5lbWl0KHRoaXMuZDNHcmFwaCk7XG4gICAgfVxuICB9XG5cbiAgY2xlYXJEYXNoZWRBcnJvdyhldjogTW91c2VFdmVudCk6IHZvaWQge1xuICAgIHRoaXMuJHN0YXRlcy5kYXNoZWRBcnJvdyA9IG51bGw7XG4gIH1cblxuICBwbHVzRGFzaGVkQXJyb3coZXY6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuJHN0YXRlcy5kYXNoZWRBcnJvdyA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogVE9ETzogU2hvdWxkIGJlIG1vdmVkIGludG8gYSBzZXJ2aWNlXG4gICAqL1xuICBhZGROb2RlKG5vZGU6IEQzTm9kZSk6IHZvaWQge1xuICAgIHRoaXMuZDNHcmFwaC5hZGROb2RlKG5vZGUpO1xuICAgIHRoaXMucmVsb2FkU2ltdWxhdGlvbigpO1xuICB9XG5cbiAgdXBkYXRlQWN0aXZlSW5kaXZpZHVhbChub2RlOiBHcmFwaENvbnRhaW5lclsnbm9kZXMnXVswXSk6IHZvaWQge1xuICAgIHRoaXMuYWN0aXZlSW5kaXZpZHVhbFN0b3JlLmFjdGl2ZUluZGl2aWR1YWwgPSBub2RlO1xuICB9XG5cbiAgY2xlYXJBY3RpdmVJbmRpdmlkdWFsKCk6IHZvaWQge1xuICAgIHRoaXMuYWN0aXZlSW5kaXZpZHVhbFN0b3JlLmNsZWFyQWN0aXZlSW5kaXZpZHVhbCgpO1xuICB9XG5cbiAgdXBkYXRlVmlld0JveChlOiB7XG4gICAgbWluWDogbnVtYmVyLCBtaW5ZOiBudW1iZXIsIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyLFxuICB9KTogdm9pZCB7XG4gICAgdGhpcy5jYW52YXNWaWV3Qm94Lm1pblggPSBlLm1pblg7XG4gICAgdGhpcy5jYW52YXNWaWV3Qm94Lm1pblkgPSBlLm1pblk7XG4gICAgdGhpcy5jYW52YXNWaWV3Qm94LndpZHRoID0gZS53aWR0aDtcbiAgICB0aGlzLmNhbnZhc1ZpZXdCb3guaGVpZ2h0ID0gZS5oZWlnaHQ7XG4gIH1cblxuICByZW1vdmVSZWxhdGlvbihldjogTW91c2VFdmVudCwgcmVsOiBHcmFwaENvbnRhaW5lclsncmVsYXRpb25zaGlwcyddWzBdKTogdm9pZCB7XG4gICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmQzR3JhcGgucmVtb3ZlUmVsYXRpb25CeUlkKHJlbC5pZCk7XG4gICAgdGhpcy5ncmFwaFVwZGF0ZWQuZW1pdCh0aGlzLmQzR3JhcGgpO1xuICAgIHRoaXMucmVsb2FkU2ltdWxhdGlvbigpO1xuICB9XG5cbn1cbiJdfQ==